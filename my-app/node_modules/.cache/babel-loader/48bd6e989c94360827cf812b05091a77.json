{"ast":null,"code":"'use strict';\n\n(function () {\n  var out$ = typeof exports != 'undefined' && exports || typeof define != 'undefined' && {} || this || window;\n  if (typeof define !== 'undefined') define('save-svg-as-png', [], function () {\n    return out$;\n  });\n  out$.default = out$;\n  var xmlNs = 'http://www.w3.org/2000/xmlns/';\n  var xhtmlNs = 'http://www.w3.org/1999/xhtml';\n  var svgNs = 'http://www.w3.org/2000/svg';\n  var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\" [<!ENTITY nbsp \"&#160;\">]>';\n  var urlRegex = /url\\([\"']?(.+?)[\"']?\\)/;\n  var fontFormats = {\n    woff2: 'font/woff2',\n    woff: 'font/woff',\n    otf: 'application/x-font-opentype',\n    ttf: 'application/x-font-ttf',\n    eot: 'application/vnd.ms-fontobject',\n    sfnt: 'application/font-sfnt',\n    svg: 'image/svg+xml'\n  };\n\n  var isElement = function isElement(obj) {\n    return obj instanceof HTMLElement || obj instanceof SVGElement;\n  };\n\n  var requireDomNode = function requireDomNode(el) {\n    if (!isElement(el)) throw new Error('an HTMLElement or SVGElement is required; got ' + el);\n  };\n\n  var requireDomNodePromise = function requireDomNodePromise(el) {\n    return new Promise(function (resolve, reject) {\n      if (isElement(el)) resolve(el);else reject(new Error('an HTMLElement or SVGElement is required; got ' + el));\n    });\n  };\n\n  var isExternal = function isExternal(url) {\n    return url && url.lastIndexOf('http', 0) === 0 && url.lastIndexOf(window.location.host) === -1;\n  };\n\n  var getFontMimeTypeFromUrl = function getFontMimeTypeFromUrl(fontUrl) {\n    var formats = Object.keys(fontFormats).filter(function (extension) {\n      return fontUrl.indexOf('.' + extension) > 0;\n    }).map(function (extension) {\n      return fontFormats[extension];\n    });\n    if (formats) return formats[0];\n    console.error('Unknown font format for ' + fontUrl + '. Fonts may not be working correctly.');\n    return 'application/octet-stream';\n  };\n\n  var arrayBufferToBase64 = function arrayBufferToBase64(buffer) {\n    var binary = '';\n    var bytes = new Uint8Array(buffer);\n\n    for (var i = 0; i < bytes.byteLength; i++) {\n      binary += String.fromCharCode(bytes[i]);\n    }\n\n    return window.btoa(binary);\n  };\n\n  var getDimension = function getDimension(el, clone, dim) {\n    var v = el.viewBox && el.viewBox.baseVal && el.viewBox.baseVal[dim] || clone.getAttribute(dim) !== null && !clone.getAttribute(dim).match(/%$/) && parseInt(clone.getAttribute(dim)) || el.getBoundingClientRect()[dim] || parseInt(clone.style[dim]) || parseInt(window.getComputedStyle(el).getPropertyValue(dim));\n    return typeof v === 'undefined' || v === null || isNaN(parseFloat(v)) ? 0 : v;\n  };\n\n  var getDimensions = function getDimensions(el, clone, width, height) {\n    if (el.tagName === 'svg') return {\n      width: width || getDimension(el, clone, 'width'),\n      height: height || getDimension(el, clone, 'height')\n    };else if (el.getBBox) {\n      var _el$getBBox = el.getBBox(),\n          x = _el$getBBox.x,\n          y = _el$getBBox.y,\n          _width = _el$getBBox.width,\n          _height = _el$getBBox.height;\n\n      return {\n        width: x + _width,\n        height: y + _height\n      };\n    }\n  };\n\n  var reEncode = function reEncode(data) {\n    return decodeURIComponent(encodeURIComponent(data).replace(/%([0-9A-F]{2})/g, function (match, p1) {\n      var c = String.fromCharCode('0x' + p1);\n      return c === '%' ? '%25' : c;\n    }));\n  };\n\n  var uriToBlob = function uriToBlob(uri) {\n    var byteString = window.atob(uri.split(',')[1]);\n    var mimeString = uri.split(',')[0].split(':')[1].split(';')[0];\n    var buffer = new ArrayBuffer(byteString.length);\n    var intArray = new Uint8Array(buffer);\n\n    for (var i = 0; i < byteString.length; i++) {\n      intArray[i] = byteString.charCodeAt(i);\n    }\n\n    return new Blob([buffer], {\n      type: mimeString\n    });\n  };\n\n  var query = function query(el, selector) {\n    if (!selector) return;\n\n    try {\n      return el.querySelector(selector) || el.parentNode && el.parentNode.querySelector(selector);\n    } catch (err) {\n      console.warn('Invalid CSS selector \"' + selector + '\"', err);\n    }\n  };\n\n  var detectCssFont = function detectCssFont(rule, href) {\n    // Match CSS font-face rules to external links.\n    // @font-face {\n    //   src: local('Abel'), url(https://fonts.gstatic.com/s/abel/v6/UzN-iejR1VoXU2Oc-7LsbvesZW2xOQ-xsNqO47m55DA.woff2);\n    // }\n    var match = rule.cssText.match(urlRegex);\n    var url = match && match[1] || '';\n    if (!url || url.match(/^data:/) || url === 'about:blank') return;\n    var fullUrl = url.startsWith('../') ? href + '/../' + url : url.startsWith('./') ? href + '/.' + url : url;\n    return {\n      text: rule.cssText,\n      format: getFontMimeTypeFromUrl(fullUrl),\n      url: fullUrl\n    };\n  };\n\n  var inlineImages = function inlineImages(el) {\n    return Promise.all(Array.from(el.querySelectorAll('image')).map(function (image) {\n      var href = image.getAttributeNS('http://www.w3.org/1999/xlink', 'href') || image.getAttribute('href');\n      if (!href) return Promise.resolve(null);\n\n      if (isExternal(href)) {\n        href += (href.indexOf('?') === -1 ? '?' : '&') + 't=' + new Date().valueOf();\n      }\n\n      return new Promise(function (resolve, reject) {\n        var canvas = document.createElement('canvas');\n        var img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.src = href;\n\n        img.onerror = function () {\n          return reject(new Error('Could not load ' + href));\n        };\n\n        img.onload = function () {\n          canvas.width = img.width;\n          canvas.height = img.height;\n          canvas.getContext('2d').drawImage(img, 0, 0);\n          image.setAttributeNS('http://www.w3.org/1999/xlink', 'href', canvas.toDataURL('image/png'));\n          resolve(true);\n        };\n      });\n    }));\n  };\n\n  var cachedFonts = {};\n\n  var inlineFonts = function inlineFonts(fonts) {\n    return Promise.all(fonts.map(function (font) {\n      return new Promise(function (resolve, reject) {\n        if (cachedFonts[font.url]) return resolve(cachedFonts[font.url]);\n        var req = new XMLHttpRequest();\n        req.addEventListener('load', function () {\n          // TODO: it may also be worth it to wait until fonts are fully loaded before\n          // attempting to rasterize them. (e.g. use https://developer.mozilla.org/en-US/docs/Web/API/FontFaceSet)\n          var fontInBase64 = arrayBufferToBase64(req.response);\n          var fontUri = font.text.replace(urlRegex, 'url(\"data:' + font.format + ';base64,' + fontInBase64 + '\")') + '\\n';\n          cachedFonts[font.url] = fontUri;\n          resolve(fontUri);\n        });\n        req.addEventListener('error', function (e) {\n          console.warn('Failed to load font from: ' + font.url, e);\n          cachedFonts[font.url] = null;\n          resolve(null);\n        });\n        req.addEventListener('abort', function (e) {\n          console.warn('Aborted loading font from: ' + font.url, e);\n          resolve(null);\n        });\n        req.open('GET', font.url);\n        req.responseType = 'arraybuffer';\n        req.send();\n      });\n    })).then(function (fontCss) {\n      return fontCss.filter(function (x) {\n        return x;\n      }).join('');\n    });\n  };\n\n  var cachedRules = null;\n\n  var styleSheetRules = function styleSheetRules() {\n    if (cachedRules) return cachedRules;\n    return cachedRules = Array.from(document.styleSheets).map(function (sheet) {\n      try {\n        return {\n          rules: sheet.cssRules,\n          href: sheet.href\n        };\n      } catch (e) {\n        console.warn('Stylesheet could not be loaded: ' + sheet.href, e);\n        return {};\n      }\n    });\n  };\n\n  var inlineCss = function inlineCss(el, options) {\n    var _ref = options || {},\n        selectorRemap = _ref.selectorRemap,\n        modifyStyle = _ref.modifyStyle,\n        modifyCss = _ref.modifyCss,\n        fonts = _ref.fonts,\n        excludeUnusedCss = _ref.excludeUnusedCss;\n\n    var generateCss = modifyCss || function (selector, properties) {\n      var sel = selectorRemap ? selectorRemap(selector) : selector;\n      var props = modifyStyle ? modifyStyle(properties) : properties;\n      return sel + '{' + props + '}\\n';\n    };\n\n    var css = [];\n    var detectFonts = typeof fonts === 'undefined';\n    var fontList = fonts || [];\n    styleSheetRules().forEach(function (_ref2) {\n      var rules = _ref2.rules,\n          href = _ref2.href;\n      if (!rules) return;\n      Array.from(rules).forEach(function (rule) {\n        if (typeof rule.style != 'undefined') {\n          if (query(el, rule.selectorText)) css.push(generateCss(rule.selectorText, rule.style.cssText));else if (detectFonts && rule.cssText.match(/^@font-face/)) {\n            var font = detectCssFont(rule, href);\n            if (font) fontList.push(font);\n          } else if (!excludeUnusedCss) {\n            css.push(rule.cssText);\n          }\n        }\n      });\n    });\n    return inlineFonts(fontList).then(function (fontCss) {\n      return css.join('\\n') + fontCss;\n    });\n  };\n\n  var downloadOptions = function downloadOptions() {\n    if (!navigator.msSaveOrOpenBlob && !('download' in document.createElement('a'))) {\n      return {\n        popup: window.open()\n      };\n    }\n  };\n\n  out$.prepareSvg = function (el, options, done) {\n    requireDomNode(el);\n\n    var _ref3 = options || {},\n        _ref3$left = _ref3.left,\n        left = _ref3$left === undefined ? 0 : _ref3$left,\n        _ref3$top = _ref3.top,\n        top = _ref3$top === undefined ? 0 : _ref3$top,\n        w = _ref3.width,\n        h = _ref3.height,\n        _ref3$scale = _ref3.scale,\n        scale = _ref3$scale === undefined ? 1 : _ref3$scale,\n        _ref3$responsive = _ref3.responsive,\n        responsive = _ref3$responsive === undefined ? false : _ref3$responsive,\n        _ref3$excludeCss = _ref3.excludeCss,\n        excludeCss = _ref3$excludeCss === undefined ? false : _ref3$excludeCss;\n\n    return inlineImages(el).then(function () {\n      var clone = el.cloneNode(true);\n      clone.style.backgroundColor = (options || {}).backgroundColor || el.style.backgroundColor;\n\n      var _getDimensions = getDimensions(el, clone, w, h),\n          width = _getDimensions.width,\n          height = _getDimensions.height;\n\n      if (el.tagName !== 'svg') {\n        if (el.getBBox) {\n          if (clone.getAttribute('transform') != null) {\n            clone.setAttribute('transform', clone.getAttribute('transform').replace(/translate\\(.*?\\)/, ''));\n          }\n\n          var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n          svg.appendChild(clone);\n          clone = svg;\n        } else {\n          console.error('Attempted to render non-SVG element', el);\n          return;\n        }\n      }\n\n      clone.setAttribute('version', '1.1');\n      clone.setAttribute('viewBox', [left, top, width, height].join(' '));\n      if (!clone.getAttribute('xmlns')) clone.setAttributeNS(xmlNs, 'xmlns', svgNs);\n      if (!clone.getAttribute('xmlns:xlink')) clone.setAttributeNS(xmlNs, 'xmlns:xlink', 'http://www.w3.org/1999/xlink');\n\n      if (responsive) {\n        clone.removeAttribute('width');\n        clone.removeAttribute('height');\n        clone.setAttribute('preserveAspectRatio', 'xMinYMin meet');\n      } else {\n        clone.setAttribute('width', width * scale);\n        clone.setAttribute('height', height * scale);\n      }\n\n      Array.from(clone.querySelectorAll('foreignObject > *')).forEach(function (foreignObject) {\n        foreignObject.setAttributeNS(xmlNs, 'xmlns', foreignObject.tagName === 'svg' ? svgNs : xhtmlNs);\n      });\n\n      if (excludeCss) {\n        var outer = document.createElement('div');\n        outer.appendChild(clone);\n        var src = outer.innerHTML;\n        if (typeof done === 'function') done(src, width, height);else return {\n          src: src,\n          width: width,\n          height: height\n        };\n      } else {\n        return inlineCss(el, options).then(function (css) {\n          var style = document.createElement('style');\n          style.setAttribute('type', 'text/css');\n          style.innerHTML = '<![CDATA[\\n' + css + '\\n]]>';\n          var defs = document.createElement('defs');\n          defs.appendChild(style);\n          clone.insertBefore(defs, clone.firstChild);\n          var outer = document.createElement('div');\n          outer.appendChild(clone);\n          var src = outer.innerHTML.replace(/NS\\d+:href/gi, 'xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href');\n          if (typeof done === 'function') done(src, width, height);else return {\n            src: src,\n            width: width,\n            height: height\n          };\n        });\n      }\n    });\n  };\n\n  out$.svgAsDataUri = function (el, options, done) {\n    requireDomNode(el);\n    return out$.prepareSvg(el, options).then(function (_ref4) {\n      var src = _ref4.src,\n          width = _ref4.width,\n          height = _ref4.height;\n      var svgXml = 'data:image/svg+xml;base64,' + window.btoa(reEncode(doctype + src));\n\n      if (typeof done === 'function') {\n        done(svgXml, width, height);\n      }\n\n      return svgXml;\n    });\n  };\n\n  out$.svgAsPngUri = function (el, options, done) {\n    requireDomNode(el);\n\n    var _ref5 = options || {},\n        _ref5$encoderType = _ref5.encoderType,\n        encoderType = _ref5$encoderType === undefined ? 'image/png' : _ref5$encoderType,\n        _ref5$encoderOptions = _ref5.encoderOptions,\n        encoderOptions = _ref5$encoderOptions === undefined ? 0.8 : _ref5$encoderOptions,\n        canvg = _ref5.canvg;\n\n    var convertToPng = function convertToPng(_ref6) {\n      var src = _ref6.src,\n          width = _ref6.width,\n          height = _ref6.height;\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      var pixelRatio = window.devicePixelRatio || 1;\n      canvas.width = width * pixelRatio;\n      canvas.height = height * pixelRatio;\n      canvas.style.width = canvas.width + 'px';\n      canvas.style.height = canvas.height + 'px';\n      context.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n      if (canvg) canvg(canvas, src);else context.drawImage(src, 0, 0);\n      var png = void 0;\n\n      try {\n        png = canvas.toDataURL(encoderType, encoderOptions);\n      } catch (e) {\n        if (typeof SecurityError !== 'undefined' && e instanceof SecurityError || e.name === 'SecurityError') {\n          console.error('Rendered SVG images cannot be downloaded in this browser.');\n          return;\n        } else throw e;\n      }\n\n      if (typeof done === 'function') done(png, canvas.width, canvas.height);\n      return Promise.resolve(png);\n    };\n\n    if (canvg) return out$.prepareSvg(el, options).then(convertToPng);else return out$.svgAsDataUri(el, options).then(function (uri) {\n      return new Promise(function (resolve, reject) {\n        var image = new Image();\n\n        image.onload = function () {\n          return resolve(convertToPng({\n            src: image,\n            width: image.width,\n            height: image.height\n          }));\n        };\n\n        image.onerror = function () {\n          reject('There was an error loading the data URI as an image on the following SVG\\n' + window.atob(uri.slice(26)) + 'Open the following link to see browser\\'s diagnosis\\n' + uri);\n        };\n\n        image.src = uri;\n      });\n    });\n  };\n\n  out$.download = function (name, uri, options) {\n    if (navigator.msSaveOrOpenBlob) navigator.msSaveOrOpenBlob(uriToBlob(uri), name);else {\n      var saveLink = document.createElement('a');\n\n      if ('download' in saveLink) {\n        saveLink.download = name;\n        saveLink.style.display = 'none';\n        document.body.appendChild(saveLink);\n\n        try {\n          var blob = uriToBlob(uri);\n          var url = URL.createObjectURL(blob);\n          saveLink.href = url;\n\n          saveLink.onclick = function () {\n            return requestAnimationFrame(function () {\n              return URL.revokeObjectURL(url);\n            });\n          };\n        } catch (e) {\n          console.error(e);\n          console.warn('Error while getting object URL. Falling back to string URL.');\n          saveLink.href = uri;\n        }\n\n        saveLink.click();\n        document.body.removeChild(saveLink);\n      } else if (options && options.popup) {\n        options.popup.document.title = name;\n        options.popup.location.replace(uri);\n      }\n    }\n  };\n\n  out$.saveSvg = function (el, name, options) {\n    var downloadOpts = downloadOptions(); // don't inline, can't be async\n\n    return requireDomNodePromise(el).then(function (el) {\n      return out$.svgAsDataUri(el, options || {});\n    }).then(function (uri) {\n      return out$.download(name, uri, downloadOpts);\n    });\n  };\n\n  out$.saveSvgAsPng = function (el, name, options) {\n    var downloadOpts = downloadOptions(); // don't inline, can't be async\n\n    return requireDomNodePromise(el).then(function (el) {\n      return out$.svgAsPngUri(el, options || {});\n    }).then(function (uri) {\n      return out$.download(name, uri, downloadOpts);\n    });\n  };\n})();","map":{"version":3,"names":["out$","exports","define","window","default","xmlNs","xhtmlNs","svgNs","doctype","urlRegex","fontFormats","woff2","woff","otf","ttf","eot","sfnt","svg","isElement","obj","HTMLElement","SVGElement","requireDomNode","el","Error","requireDomNodePromise","Promise","resolve","reject","isExternal","url","lastIndexOf","location","host","getFontMimeTypeFromUrl","fontUrl","formats","Object","keys","filter","extension","indexOf","map","console","error","arrayBufferToBase64","buffer","binary","bytes","Uint8Array","i","byteLength","String","fromCharCode","btoa","getDimension","clone","dim","v","viewBox","baseVal","getAttribute","match","parseInt","getBoundingClientRect","style","getComputedStyle","getPropertyValue","isNaN","parseFloat","getDimensions","width","height","tagName","getBBox","_el$getBBox","x","y","_width","_height","reEncode","data","decodeURIComponent","encodeURIComponent","replace","p1","c","uriToBlob","uri","byteString","atob","split","mimeString","ArrayBuffer","length","intArray","charCodeAt","Blob","type","query","selector","querySelector","parentNode","err","warn","detectCssFont","rule","href","cssText","fullUrl","startsWith","text","format","inlineImages","all","Array","from","querySelectorAll","image","getAttributeNS","Date","valueOf","canvas","document","createElement","img","Image","crossOrigin","src","onerror","onload","getContext","drawImage","setAttributeNS","toDataURL","cachedFonts","inlineFonts","fonts","font","req","XMLHttpRequest","addEventListener","fontInBase64","response","fontUri","e","open","responseType","send","then","fontCss","join","cachedRules","styleSheetRules","styleSheets","sheet","rules","cssRules","inlineCss","options","_ref","selectorRemap","modifyStyle","modifyCss","excludeUnusedCss","generateCss","properties","sel","props","css","detectFonts","fontList","forEach","_ref2","selectorText","push","downloadOptions","navigator","msSaveOrOpenBlob","popup","prepareSvg","done","_ref3","_ref3$left","left","undefined","_ref3$top","top","w","h","_ref3$scale","scale","_ref3$responsive","responsive","_ref3$excludeCss","excludeCss","cloneNode","backgroundColor","_getDimensions","setAttribute","createElementNS","appendChild","removeAttribute","foreignObject","outer","innerHTML","defs","insertBefore","firstChild","svgAsDataUri","_ref4","svgXml","svgAsPngUri","_ref5","_ref5$encoderType","encoderType","_ref5$encoderOptions","encoderOptions","canvg","convertToPng","_ref6","context","pixelRatio","devicePixelRatio","setTransform","png","SecurityError","name","slice","download","saveLink","display","body","blob","URL","createObjectURL","onclick","requestAnimationFrame","revokeObjectURL","click","removeChild","title","saveSvg","downloadOpts","saveSvgAsPng"],"sources":["/home/chenak/QbitesReact/my-app/node_modules/save-svg-as-png/lib/saveSvgAsPng.js"],"sourcesContent":["'use strict';\n\n(function () {\n  var out$ = typeof exports != 'undefined' && exports || typeof define != 'undefined' && {} || this || window;\n  if (typeof define !== 'undefined') define('save-svg-as-png', [], function () {\n    return out$;\n  });\n  out$.default = out$;\n\n  var xmlNs = 'http://www.w3.org/2000/xmlns/';\n  var xhtmlNs = 'http://www.w3.org/1999/xhtml';\n  var svgNs = 'http://www.w3.org/2000/svg';\n  var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\" [<!ENTITY nbsp \"&#160;\">]>';\n  var urlRegex = /url\\([\"']?(.+?)[\"']?\\)/;\n  var fontFormats = {\n    woff2: 'font/woff2',\n    woff: 'font/woff',\n    otf: 'application/x-font-opentype',\n    ttf: 'application/x-font-ttf',\n    eot: 'application/vnd.ms-fontobject',\n    sfnt: 'application/font-sfnt',\n    svg: 'image/svg+xml'\n  };\n\n  var isElement = function isElement(obj) {\n    return obj instanceof HTMLElement || obj instanceof SVGElement;\n  };\n  var requireDomNode = function requireDomNode(el) {\n    if (!isElement(el)) throw new Error('an HTMLElement or SVGElement is required; got ' + el);\n  };\n  var requireDomNodePromise = function requireDomNodePromise(el) {\n    return new Promise(function (resolve, reject) {\n      if (isElement(el)) resolve(el);else reject(new Error('an HTMLElement or SVGElement is required; got ' + el));\n    });\n  };\n  var isExternal = function isExternal(url) {\n    return url && url.lastIndexOf('http', 0) === 0 && url.lastIndexOf(window.location.host) === -1;\n  };\n\n  var getFontMimeTypeFromUrl = function getFontMimeTypeFromUrl(fontUrl) {\n    var formats = Object.keys(fontFormats).filter(function (extension) {\n      return fontUrl.indexOf('.' + extension) > 0;\n    }).map(function (extension) {\n      return fontFormats[extension];\n    });\n    if (formats) return formats[0];\n    console.error('Unknown font format for ' + fontUrl + '. Fonts may not be working correctly.');\n    return 'application/octet-stream';\n  };\n\n  var arrayBufferToBase64 = function arrayBufferToBase64(buffer) {\n    var binary = '';\n    var bytes = new Uint8Array(buffer);\n    for (var i = 0; i < bytes.byteLength; i++) {\n      binary += String.fromCharCode(bytes[i]);\n    }return window.btoa(binary);\n  };\n\n  var getDimension = function getDimension(el, clone, dim) {\n    var v = el.viewBox && el.viewBox.baseVal && el.viewBox.baseVal[dim] || clone.getAttribute(dim) !== null && !clone.getAttribute(dim).match(/%$/) && parseInt(clone.getAttribute(dim)) || el.getBoundingClientRect()[dim] || parseInt(clone.style[dim]) || parseInt(window.getComputedStyle(el).getPropertyValue(dim));\n    return typeof v === 'undefined' || v === null || isNaN(parseFloat(v)) ? 0 : v;\n  };\n\n  var getDimensions = function getDimensions(el, clone, width, height) {\n    if (el.tagName === 'svg') return {\n      width: width || getDimension(el, clone, 'width'),\n      height: height || getDimension(el, clone, 'height')\n    };else if (el.getBBox) {\n      var _el$getBBox = el.getBBox(),\n          x = _el$getBBox.x,\n          y = _el$getBBox.y,\n          _width = _el$getBBox.width,\n          _height = _el$getBBox.height;\n\n      return {\n        width: x + _width,\n        height: y + _height\n      };\n    }\n  };\n\n  var reEncode = function reEncode(data) {\n    return decodeURIComponent(encodeURIComponent(data).replace(/%([0-9A-F]{2})/g, function (match, p1) {\n      var c = String.fromCharCode('0x' + p1);\n      return c === '%' ? '%25' : c;\n    }));\n  };\n\n  var uriToBlob = function uriToBlob(uri) {\n    var byteString = window.atob(uri.split(',')[1]);\n    var mimeString = uri.split(',')[0].split(':')[1].split(';')[0];\n    var buffer = new ArrayBuffer(byteString.length);\n    var intArray = new Uint8Array(buffer);\n    for (var i = 0; i < byteString.length; i++) {\n      intArray[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([buffer], { type: mimeString });\n  };\n\n  var query = function query(el, selector) {\n    if (!selector) return;\n    try {\n      return el.querySelector(selector) || el.parentNode && el.parentNode.querySelector(selector);\n    } catch (err) {\n      console.warn('Invalid CSS selector \"' + selector + '\"', err);\n    }\n  };\n\n  var detectCssFont = function detectCssFont(rule, href) {\n    // Match CSS font-face rules to external links.\n    // @font-face {\n    //   src: local('Abel'), url(https://fonts.gstatic.com/s/abel/v6/UzN-iejR1VoXU2Oc-7LsbvesZW2xOQ-xsNqO47m55DA.woff2);\n    // }\n    var match = rule.cssText.match(urlRegex);\n    var url = match && match[1] || '';\n    if (!url || url.match(/^data:/) || url === 'about:blank') return;\n    var fullUrl = url.startsWith('../') ? href + '/../' + url : url.startsWith('./') ? href + '/.' + url : url;\n    return {\n      text: rule.cssText,\n      format: getFontMimeTypeFromUrl(fullUrl),\n      url: fullUrl\n    };\n  };\n\n  var inlineImages = function inlineImages(el) {\n    return Promise.all(Array.from(el.querySelectorAll('image')).map(function (image) {\n      var href = image.getAttributeNS('http://www.w3.org/1999/xlink', 'href') || image.getAttribute('href');\n      if (!href) return Promise.resolve(null);\n      if (isExternal(href)) {\n        href += (href.indexOf('?') === -1 ? '?' : '&') + 't=' + new Date().valueOf();\n      }\n      return new Promise(function (resolve, reject) {\n        var canvas = document.createElement('canvas');\n        var img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.src = href;\n        img.onerror = function () {\n          return reject(new Error('Could not load ' + href));\n        };\n        img.onload = function () {\n          canvas.width = img.width;\n          canvas.height = img.height;\n          canvas.getContext('2d').drawImage(img, 0, 0);\n          image.setAttributeNS('http://www.w3.org/1999/xlink', 'href', canvas.toDataURL('image/png'));\n          resolve(true);\n        };\n      });\n    }));\n  };\n\n  var cachedFonts = {};\n  var inlineFonts = function inlineFonts(fonts) {\n    return Promise.all(fonts.map(function (font) {\n      return new Promise(function (resolve, reject) {\n        if (cachedFonts[font.url]) return resolve(cachedFonts[font.url]);\n\n        var req = new XMLHttpRequest();\n        req.addEventListener('load', function () {\n          // TODO: it may also be worth it to wait until fonts are fully loaded before\n          // attempting to rasterize them. (e.g. use https://developer.mozilla.org/en-US/docs/Web/API/FontFaceSet)\n          var fontInBase64 = arrayBufferToBase64(req.response);\n          var fontUri = font.text.replace(urlRegex, 'url(\"data:' + font.format + ';base64,' + fontInBase64 + '\")') + '\\n';\n          cachedFonts[font.url] = fontUri;\n          resolve(fontUri);\n        });\n        req.addEventListener('error', function (e) {\n          console.warn('Failed to load font from: ' + font.url, e);\n          cachedFonts[font.url] = null;\n          resolve(null);\n        });\n        req.addEventListener('abort', function (e) {\n          console.warn('Aborted loading font from: ' + font.url, e);\n          resolve(null);\n        });\n        req.open('GET', font.url);\n        req.responseType = 'arraybuffer';\n        req.send();\n      });\n    })).then(function (fontCss) {\n      return fontCss.filter(function (x) {\n        return x;\n      }).join('');\n    });\n  };\n\n  var cachedRules = null;\n  var styleSheetRules = function styleSheetRules() {\n    if (cachedRules) return cachedRules;\n    return cachedRules = Array.from(document.styleSheets).map(function (sheet) {\n      try {\n        return { rules: sheet.cssRules, href: sheet.href };\n      } catch (e) {\n        console.warn('Stylesheet could not be loaded: ' + sheet.href, e);\n        return {};\n      }\n    });\n  };\n\n  var inlineCss = function inlineCss(el, options) {\n    var _ref = options || {},\n        selectorRemap = _ref.selectorRemap,\n        modifyStyle = _ref.modifyStyle,\n        modifyCss = _ref.modifyCss,\n        fonts = _ref.fonts,\n        excludeUnusedCss = _ref.excludeUnusedCss;\n\n    var generateCss = modifyCss || function (selector, properties) {\n      var sel = selectorRemap ? selectorRemap(selector) : selector;\n      var props = modifyStyle ? modifyStyle(properties) : properties;\n      return sel + '{' + props + '}\\n';\n    };\n    var css = [];\n    var detectFonts = typeof fonts === 'undefined';\n    var fontList = fonts || [];\n    styleSheetRules().forEach(function (_ref2) {\n      var rules = _ref2.rules,\n          href = _ref2.href;\n\n      if (!rules) return;\n      Array.from(rules).forEach(function (rule) {\n        if (typeof rule.style != 'undefined') {\n          if (query(el, rule.selectorText)) css.push(generateCss(rule.selectorText, rule.style.cssText));else if (detectFonts && rule.cssText.match(/^@font-face/)) {\n            var font = detectCssFont(rule, href);\n            if (font) fontList.push(font);\n          } else if (!excludeUnusedCss) {\n            css.push(rule.cssText);\n          }\n        }\n      });\n    });\n\n    return inlineFonts(fontList).then(function (fontCss) {\n      return css.join('\\n') + fontCss;\n    });\n  };\n\n  var downloadOptions = function downloadOptions() {\n    if (!navigator.msSaveOrOpenBlob && !('download' in document.createElement('a'))) {\n      return { popup: window.open() };\n    }\n  };\n\n  out$.prepareSvg = function (el, options, done) {\n    requireDomNode(el);\n\n    var _ref3 = options || {},\n        _ref3$left = _ref3.left,\n        left = _ref3$left === undefined ? 0 : _ref3$left,\n        _ref3$top = _ref3.top,\n        top = _ref3$top === undefined ? 0 : _ref3$top,\n        w = _ref3.width,\n        h = _ref3.height,\n        _ref3$scale = _ref3.scale,\n        scale = _ref3$scale === undefined ? 1 : _ref3$scale,\n        _ref3$responsive = _ref3.responsive,\n        responsive = _ref3$responsive === undefined ? false : _ref3$responsive,\n        _ref3$excludeCss = _ref3.excludeCss,\n        excludeCss = _ref3$excludeCss === undefined ? false : _ref3$excludeCss;\n\n    return inlineImages(el).then(function () {\n      var clone = el.cloneNode(true);\n      clone.style.backgroundColor = (options || {}).backgroundColor || el.style.backgroundColor;\n\n      var _getDimensions = getDimensions(el, clone, w, h),\n          width = _getDimensions.width,\n          height = _getDimensions.height;\n\n      if (el.tagName !== 'svg') {\n        if (el.getBBox) {\n          if (clone.getAttribute('transform') != null) {\n            clone.setAttribute('transform', clone.getAttribute('transform').replace(/translate\\(.*?\\)/, ''));\n          }\n          var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n          svg.appendChild(clone);\n          clone = svg;\n        } else {\n          console.error('Attempted to render non-SVG element', el);\n          return;\n        }\n      }\n\n      clone.setAttribute('version', '1.1');\n      clone.setAttribute('viewBox', [left, top, width, height].join(' '));\n      if (!clone.getAttribute('xmlns')) clone.setAttributeNS(xmlNs, 'xmlns', svgNs);\n      if (!clone.getAttribute('xmlns:xlink')) clone.setAttributeNS(xmlNs, 'xmlns:xlink', 'http://www.w3.org/1999/xlink');\n\n      if (responsive) {\n        clone.removeAttribute('width');\n        clone.removeAttribute('height');\n        clone.setAttribute('preserveAspectRatio', 'xMinYMin meet');\n      } else {\n        clone.setAttribute('width', width * scale);\n        clone.setAttribute('height', height * scale);\n      }\n\n      Array.from(clone.querySelectorAll('foreignObject > *')).forEach(function (foreignObject) {\n        foreignObject.setAttributeNS(xmlNs, 'xmlns', foreignObject.tagName === 'svg' ? svgNs : xhtmlNs);\n      });\n\n      if (excludeCss) {\n        var outer = document.createElement('div');\n        outer.appendChild(clone);\n        var src = outer.innerHTML;\n        if (typeof done === 'function') done(src, width, height);else return { src: src, width: width, height: height };\n      } else {\n        return inlineCss(el, options).then(function (css) {\n          var style = document.createElement('style');\n          style.setAttribute('type', 'text/css');\n          style.innerHTML = '<![CDATA[\\n' + css + '\\n]]>';\n\n          var defs = document.createElement('defs');\n          defs.appendChild(style);\n          clone.insertBefore(defs, clone.firstChild);\n\n          var outer = document.createElement('div');\n          outer.appendChild(clone);\n          var src = outer.innerHTML.replace(/NS\\d+:href/gi, 'xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href');\n\n          if (typeof done === 'function') done(src, width, height);else return { src: src, width: width, height: height };\n        });\n      }\n    });\n  };\n\n  out$.svgAsDataUri = function (el, options, done) {\n    requireDomNode(el);\n    return out$.prepareSvg(el, options).then(function (_ref4) {\n      var src = _ref4.src,\n          width = _ref4.width,\n          height = _ref4.height;\n\n      var svgXml = 'data:image/svg+xml;base64,' + window.btoa(reEncode(doctype + src));\n      if (typeof done === 'function') {\n        done(svgXml, width, height);\n      }\n      return svgXml;\n    });\n  };\n\n  out$.svgAsPngUri = function (el, options, done) {\n    requireDomNode(el);\n\n    var _ref5 = options || {},\n        _ref5$encoderType = _ref5.encoderType,\n        encoderType = _ref5$encoderType === undefined ? 'image/png' : _ref5$encoderType,\n        _ref5$encoderOptions = _ref5.encoderOptions,\n        encoderOptions = _ref5$encoderOptions === undefined ? 0.8 : _ref5$encoderOptions,\n        canvg = _ref5.canvg;\n\n    var convertToPng = function convertToPng(_ref6) {\n      var src = _ref6.src,\n          width = _ref6.width,\n          height = _ref6.height;\n\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      var pixelRatio = window.devicePixelRatio || 1;\n\n      canvas.width = width * pixelRatio;\n      canvas.height = height * pixelRatio;\n      canvas.style.width = canvas.width + 'px';\n      canvas.style.height = canvas.height + 'px';\n      context.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n\n      if (canvg) canvg(canvas, src);else context.drawImage(src, 0, 0);\n\n      var png = void 0;\n      try {\n        png = canvas.toDataURL(encoderType, encoderOptions);\n      } catch (e) {\n        if (typeof SecurityError !== 'undefined' && e instanceof SecurityError || e.name === 'SecurityError') {\n          console.error('Rendered SVG images cannot be downloaded in this browser.');\n          return;\n        } else throw e;\n      }\n      if (typeof done === 'function') done(png, canvas.width, canvas.height);\n      return Promise.resolve(png);\n    };\n\n    if (canvg) return out$.prepareSvg(el, options).then(convertToPng);else return out$.svgAsDataUri(el, options).then(function (uri) {\n      return new Promise(function (resolve, reject) {\n        var image = new Image();\n        image.onload = function () {\n          return resolve(convertToPng({\n            src: image,\n            width: image.width,\n            height: image.height\n          }));\n        };\n        image.onerror = function () {\n          reject('There was an error loading the data URI as an image on the following SVG\\n' + window.atob(uri.slice(26)) + 'Open the following link to see browser\\'s diagnosis\\n' + uri);\n        };\n        image.src = uri;\n      });\n    });\n  };\n\n  out$.download = function (name, uri, options) {\n    if (navigator.msSaveOrOpenBlob) navigator.msSaveOrOpenBlob(uriToBlob(uri), name);else {\n      var saveLink = document.createElement('a');\n      if ('download' in saveLink) {\n        saveLink.download = name;\n        saveLink.style.display = 'none';\n        document.body.appendChild(saveLink);\n        try {\n          var blob = uriToBlob(uri);\n          var url = URL.createObjectURL(blob);\n          saveLink.href = url;\n          saveLink.onclick = function () {\n            return requestAnimationFrame(function () {\n              return URL.revokeObjectURL(url);\n            });\n          };\n        } catch (e) {\n          console.error(e);\n          console.warn('Error while getting object URL. Falling back to string URL.');\n          saveLink.href = uri;\n        }\n        saveLink.click();\n        document.body.removeChild(saveLink);\n      } else if (options && options.popup) {\n        options.popup.document.title = name;\n        options.popup.location.replace(uri);\n      }\n    }\n  };\n\n  out$.saveSvg = function (el, name, options) {\n    var downloadOpts = downloadOptions(); // don't inline, can't be async\n    return requireDomNodePromise(el).then(function (el) {\n      return out$.svgAsDataUri(el, options || {});\n    }).then(function (uri) {\n      return out$.download(name, uri, downloadOpts);\n    });\n  };\n\n  out$.saveSvgAsPng = function (el, name, options) {\n    var downloadOpts = downloadOptions(); // don't inline, can't be async\n    return requireDomNodePromise(el).then(function (el) {\n      return out$.svgAsPngUri(el, options || {});\n    }).then(function (uri) {\n      return out$.download(name, uri, downloadOpts);\n    });\n  };\n})();"],"mappings":"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"},"metadata":{},"sourceType":"script"}
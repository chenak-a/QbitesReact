{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _d3Array = require(\"d3-array\");\n\nvar _d3Path = require(\"d3-path\");\n\nvar _GenericChartComponent = require(\"../../GenericChartComponent\");\n\nvar _GenericChartComponent2 = _interopRequireDefault(_GenericChartComponent);\n\nvar _GenericComponent = require(\"../../GenericComponent\");\n\nvar _StraightLine = require(\"./StraightLine\");\n\nvar _utils = require(\"../../utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar GannFan = function (_Component) {\n  _inherits(GannFan, _Component);\n\n  function GannFan(props) {\n    _classCallCheck(this, GannFan);\n\n    var _this = _possibleConstructorReturn(this, (GannFan.__proto__ || Object.getPrototypeOf(GannFan)).call(this, props));\n\n    _this.renderSVG = _this.renderSVG.bind(_this);\n    _this.drawOnCanvas = _this.drawOnCanvas.bind(_this);\n    _this.isHover = _this.isHover.bind(_this);\n    return _this;\n  }\n\n  _createClass(GannFan, [{\n    key: \"isHover\",\n    value: function isHover(moreProps) {\n      var _props = this.props,\n          tolerance = _props.tolerance,\n          onHover = _props.onHover;\n      var mouseXY = moreProps.mouseXY;\n\n      var _mouseXY = _slicedToArray(mouseXY, 2),\n          mouseX = _mouseXY[0],\n          mouseY = _mouseXY[1];\n\n      var hovering = false;\n\n      if ((0, _utils.isDefined)(onHover)) {\n        var lines = helper(this.props, moreProps);\n\n        for (var i = 0; i < lines.length; i++) {\n          var line1 = lines[i];\n          var left = Math.min(line1.x1, line1.x2);\n          var right = Math.max(line1.x1, line1.x2);\n          var top = Math.min(line1.y1, line1.y2);\n          var bottom = Math.max(line1.y1, line1.y2);\n          var isWithinLineBounds = mouseX >= left && mouseX <= right && mouseY >= top && mouseY <= bottom;\n          hovering = isWithinLineBounds && (0, _StraightLine.isHovering2)([line1.x1, line1.y1], [line1.x2, line1.y2], mouseXY, tolerance);\n          if (hovering) break;\n        }\n      }\n\n      return hovering;\n    }\n  }, {\n    key: \"drawOnCanvas\",\n    value: function drawOnCanvas(ctx, moreProps) {\n      var _props2 = this.props,\n          stroke = _props2.stroke,\n          strokeWidth = _props2.strokeWidth,\n          strokeOpacity = _props2.strokeOpacity,\n          fill = _props2.fill,\n          fillOpacity = _props2.fillOpacity,\n          fontFamily = _props2.fontFamily,\n          fontSize = _props2.fontSize,\n          fontFill = _props2.fontFill;\n      var lines = helper(this.props, moreProps);\n      ctx.lineWidth = strokeWidth;\n      ctx.strokeStyle = (0, _utils.hexToRGBA)(stroke, strokeOpacity);\n      ctx.font = fontSize + \"px \" + fontFamily;\n      ctx.fillStyle = fontFill;\n      lines.forEach(function (line) {\n        var x1 = line.x1,\n            y1 = line.y1,\n            x2 = line.x2,\n            y2 = line.y2,\n            label = line.label;\n        ctx.beginPath();\n        ctx.moveTo(x1, y1);\n        ctx.lineTo(x2, y2);\n        ctx.stroke();\n        ctx.beginPath();\n        ctx.fillText(label.text, label.x, label.y);\n      });\n      var pairsOfLines = (0, _d3Array.pairs)(lines);\n      pairsOfLines.forEach(function (_ref, idx) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            line1 = _ref2[0],\n            line2 = _ref2[1];\n\n        ctx.fillStyle = (0, _utils.hexToRGBA)(fill[idx], fillOpacity);\n        ctx.beginPath();\n        ctx.moveTo(line1.x1, line1.y1);\n        ctx.lineTo(line1.x2, line1.y2);\n        ctx.lineTo(line2.x2, line2.y2);\n        ctx.closePath();\n        ctx.fill();\n      });\n    }\n  }, {\n    key: \"renderSVG\",\n    value: function renderSVG(moreProps) {\n      var _props3 = this.props,\n          stroke = _props3.stroke,\n          strokeWidth = _props3.strokeWidth,\n          fillOpacity = _props3.fillOpacity,\n          fill = _props3.fill,\n          strokeOpacity = _props3.strokeOpacity;\n      var lines = helper(this.props, moreProps);\n      var pairsOfLines = (0, _d3Array.pairs)(lines);\n      return _react2.default.createElement(\"g\", null, lines.map(function (each, idx) {\n        var x1 = each.x1,\n            y1 = each.y1,\n            x2 = each.x2,\n            y2 = each.y2;\n        return _react2.default.createElement(\"line\", {\n          key: idx,\n          strokeWidth: strokeWidth,\n          stroke: stroke,\n          strokeOpacity: strokeOpacity,\n          x1: x1,\n          y1: y1,\n          x2: x2,\n          y2: y2\n        });\n      }), pairsOfLines.map(function (_ref3, idx) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            line1 = _ref4[0],\n            line2 = _ref4[1];\n\n        var ctx = (0, _d3Path.path)();\n        ctx.moveTo(line1.x1, line1.y1);\n        ctx.lineTo(line1.x2, line1.y2);\n        ctx.lineTo(line2.x2, line2.y2);\n        ctx.closePath();\n        return _react2.default.createElement(\"path\", {\n          key: idx,\n          stroke: \"none\",\n          fill: fill[idx],\n          fillOpacity: fillOpacity,\n          d: ctx.toString()\n        });\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props4 = this.props,\n          selected = _props4.selected,\n          interactiveCursorClass = _props4.interactiveCursorClass;\n      var _props5 = this.props,\n          onDragStart = _props5.onDragStart,\n          onDrag = _props5.onDrag,\n          onDragComplete = _props5.onDragComplete,\n          onHover = _props5.onHover,\n          onUnHover = _props5.onUnHover;\n      return _react2.default.createElement(_GenericChartComponent2.default, {\n        isHover: this.isHover,\n        svgDraw: this.renderSVG,\n        canvasToDraw: _GenericComponent.getMouseCanvas,\n        canvasDraw: this.drawOnCanvas,\n        interactiveCursorClass: interactiveCursorClass,\n        selected: selected,\n        onDragStart: onDragStart,\n        onDrag: onDrag,\n        onDragComplete: onDragComplete,\n        onHover: onHover,\n        onUnHover: onUnHover,\n        drawOn: [\"mousemove\", \"mouseleave\", \"pan\", \"drag\"]\n      });\n    }\n  }]);\n\n  return GannFan;\n}(_react.Component);\n\nfunction getLineCoordinates(start, endX, endY, text) {\n  var end = [endX, endY];\n  return {\n    start: start,\n    end: end,\n    text: text\n  };\n}\n\nfunction helper(props, moreProps) {\n  var startXY = props.startXY,\n      endXY = props.endXY;\n  var xScale = moreProps.xScale,\n      yScale = moreProps.chartConfig.yScale;\n\n  if ((0, _utils.isNotDefined)(startXY) || (0, _utils.isNotDefined)(endXY)) {\n    return [];\n  }\n\n  var _startXY = _slicedToArray(startXY, 2),\n      x1 = _startXY[0],\n      y1 = _startXY[1];\n\n  var _endXY = _slicedToArray(endXY, 2),\n      x2 = _endXY[0],\n      y2 = _endXY[1];\n\n  var dx = x2 - x1;\n  var dy = y2 - y1;\n\n  if (dx !== 0 && dy !== 0) {\n    // console.log(\"modLine ->\", startXY, modLine, dx1, dy1)\n    var halfY = getLineCoordinates(startXY, x2, y1 + dy / 2, \"2/1\");\n    var oneThirdY = getLineCoordinates(startXY, x2, y1 + dy / 3, \"3/1\");\n    var oneFourthY = getLineCoordinates(startXY, x2, y1 + dy / 4, \"4/1\");\n    var oneEighthY = getLineCoordinates(startXY, x2, y1 + dy / 8, \"8/1\");\n    var halfX = getLineCoordinates(startXY, x1 + dx / 2, y2, \"1/2\");\n    var oneThirdX = getLineCoordinates(startXY, x1 + dx / 3, y2, \"1/3\");\n    var oneFourthX = getLineCoordinates(startXY, x1 + dx / 4, y2, \"1/4\");\n    var oneEighthX = getLineCoordinates(startXY, x1 + dx / 8, y2, \"1/8\");\n    var lines = [oneEighthX, oneFourthX, oneThirdX, halfX, {\n      start: startXY,\n      end: endXY,\n      text: \"1/1\"\n    }, halfY, oneThirdY, oneFourthY, oneEighthY];\n    var lineCoods = lines.map(function (line) {\n      var _generateLine = (0, _StraightLine.generateLine)({\n        type: \"RAY\",\n        start: line.start,\n        end: line.end,\n        xScale: xScale,\n        yScale: yScale\n      }),\n          x1 = _generateLine.x1,\n          y1 = _generateLine.y1,\n          x2 = _generateLine.x2,\n          y2 = _generateLine.y2;\n\n      return {\n        x1: xScale(x1),\n        y1: yScale(y1),\n        x2: xScale(x2),\n        y2: yScale(y2),\n        label: {\n          x: xScale(line.end[0]),\n          y: yScale(line.end[1]),\n          text: line.text\n        }\n      };\n    });\n    return lineCoods;\n  }\n\n  return [];\n}\n\nGannFan.propTypes = {\n  interactiveCursorClass: _propTypes2.default.string,\n  stroke: _propTypes2.default.string.isRequired,\n  strokeWidth: _propTypes2.default.number.isRequired,\n  fill: _propTypes2.default.arrayOf(_propTypes2.default.string).isRequired,\n  strokeOpacity: _propTypes2.default.number.isRequired,\n  fillOpacity: _propTypes2.default.number.isRequired,\n  fontFamily: _propTypes2.default.string.isRequired,\n  fontSize: _propTypes2.default.number.isRequired,\n  fontFill: _propTypes2.default.string.isRequired,\n  onDragStart: _propTypes2.default.func.isRequired,\n  onDrag: _propTypes2.default.func.isRequired,\n  onDragComplete: _propTypes2.default.func.isRequired,\n  onHover: _propTypes2.default.func,\n  onUnHover: _propTypes2.default.func,\n  defaultClassName: _propTypes2.default.string,\n  tolerance: _propTypes2.default.number.isRequired,\n  selected: _propTypes2.default.bool.isRequired\n};\nGannFan.defaultProps = {\n  onDragStart: _utils.noop,\n  onDrag: _utils.noop,\n  onDragComplete: _utils.noop,\n  strokeWidth: 1,\n  tolerance: 4,\n  selected: false\n};\nexports.default = GannFan;","map":{"version":3,"mappings":"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","names":["GannFan","props","_classCallCheck","_this","renderSVG","bind","drawOnCanvas","isHover","moreProps","tolerance","onHover","mouseXY","mouseX","mouseY","hovering","lines","helper","i","length","line1","left","Math","min","x1","x2","right","max","top","y1","y2","bottom","isWithinLineBounds","ctx","stroke","strokeWidth","strokeOpacity","fill","fillOpacity","fontFamily","fontSize","fontFill","lineWidth","strokeStyle","font","fillStyle","forEach","line","label","beginPath","moveTo","lineTo","fillText","text","x","y","pairsOfLines","idx","line2","closePath","_react2","map","each","key","d","toString","selected","interactiveCursorClass","onDragStart","onDrag","onDragComplete","onUnHover","svgDraw","canvasToDraw","canvasDraw","drawOn","getLineCoordinates","start","endX","endY","end","startXY","endXY","xScale","yScale","chartConfig","dx","dy","halfY","oneThirdY","oneFourthY","oneEighthY","halfX","oneThirdX","oneFourthX","oneEighthX","lineCoods","type","propTypes","_propTypes2","string","isRequired","number","arrayOf","func","defaultClassName","bool","defaultProps"],"sources":["../../../../src/lib/interactive/components/GannFan.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { pairs } from \"d3-array\";\nimport { path as d3Path } from \"d3-path\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { getMouseCanvas } from \"../../GenericComponent\";\nimport { generateLine, isHovering2 } from \"./StraightLine\";\n\nimport {\n\tisDefined, isNotDefined,\n\tnoop, hexToRGBA,\n} from \"../../utils\";\n\nclass GannFan extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t\tthis.isHover = this.isHover.bind(this);\n\t}\n\tisHover(moreProps) {\n\t\tconst { tolerance, onHover } = this.props;\n\t\tconst { mouseXY } = moreProps;\n\t\tconst [mouseX, mouseY] = mouseXY;\n\n\t\tlet hovering = false;\n\t\tif (isDefined(onHover)) {\n\n\t\t\tconst lines = helper(this.props, moreProps);\n\n\t\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\t\tconst line1 = lines[i];\n\n\t\t\t\tconst left = Math.min(line1.x1, line1.x2);\n\t\t\t\tconst right = Math.max(line1.x1, line1.x2);\n\t\t\t\tconst top = Math.min(line1.y1, line1.y2);\n\t\t\t\tconst bottom = Math.max(line1.y1, line1.y2);\n\n\t\t\t\tconst isWithinLineBounds = mouseX >= left && mouseX <= right\n\t\t\t\t\t&& mouseY >= top && mouseY <= bottom;\n\n\t\t\t\thovering = isWithinLineBounds\n\t\t\t\t\t&& isHovering2(\n\t\t\t\t\t\t[line1.x1, line1.y1],\n\t\t\t\t\t\t[line1.x2, line1.y2],\n\t\t\t\t\t\tmouseXY,\n\t\t\t\t\t\ttolerance);\n\n\t\t\t\tif (hovering) break;\n\t\t\t}\n\t\t}\n\t\treturn hovering;\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst {\n\t\t\tstroke, strokeWidth, strokeOpacity,\n\t\t\tfill, fillOpacity,\n\t\t\tfontFamily, fontSize, fontFill\n\t\t} = this.props;\n\n\n\t\tconst lines = helper(this.props, moreProps);\n\n\t\tctx.lineWidth = strokeWidth;\n\t\tctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\n\n\t\tctx.font = `${ fontSize }px ${fontFamily}`;\n\t\tctx.fillStyle = fontFill;\n\n\t\tlines.forEach(line => {\n\t\t\tconst {\n\t\t\t\tx1, y1, x2, y2, label\n\t\t\t} = line;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(x1, y1);\n\t\t\tctx.lineTo(x2, y2);\n\t\t\tctx.stroke();\n\t\t\tctx.beginPath();\n\t\t\tctx.fillText(label.text, label.x, label.y);\n\t\t});\n\t\tconst pairsOfLines = pairs(lines);\n\n\t\tpairsOfLines.forEach(([line1, line2], idx) => {\n\t\t\tctx.fillStyle = hexToRGBA(fill[idx], fillOpacity);\n\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(line1.x1, line1.y1);\n\t\t\tctx.lineTo(line1.x2, line1.y2);\n\t\t\tctx.lineTo(line2.x2, line2.y2);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t});\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { stroke, strokeWidth, fillOpacity, fill, strokeOpacity } = this.props;\n\n\t\tconst lines = helper(this.props, moreProps);\n\t\tconst pairsOfLines = pairs(lines);\n\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t{lines.map((each, idx) => {\n\t\t\t\t\tconst { x1, y1, x2, y2 } = each;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<line key={idx}\n\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\tstroke={stroke}\n\t\t\t\t\t\t\tstrokeOpacity={strokeOpacity}\n\t\t\t\t\t\t\tx1={x1}\n\t\t\t\t\t\t\ty1={y1}\n\t\t\t\t\t\t\tx2={x2}\n\t\t\t\t\t\t\ty2={y2}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t\t{pairsOfLines.map(([line1, line2], idx) => {\n\t\t\t\t\tconst ctx = d3Path();\n\t\t\t\t\tctx.moveTo(line1.x1, line1.y1);\n\t\t\t\t\tctx.lineTo(line1.x2, line1.y2);\n\t\t\t\t\tctx.lineTo(line2.x2, line2.y2);\n\t\t\t\t\tctx.closePath();\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<path key={idx}\n\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\tfill={fill[idx]}\n\t\t\t\t\t\t\tfillOpacity={fillOpacity}\n\t\t\t\t\t\t\td={ctx.toString()}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</g>\n\t\t);\n\t}\n\trender() {\n\t\tconst { selected, interactiveCursorClass } = this.props;\n\t\tconst { onDragStart, onDrag, onDragComplete, onHover, onUnHover } = this.props;\n\n\t\treturn <GenericChartComponent\n\t\t\tisHover={this.isHover}\n\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\n\t\t\tinteractiveCursorClass={interactiveCursorClass}\n\t\t\tselected={selected}\n\n\t\t\tonDragStart={onDragStart}\n\t\t\tonDrag={onDrag}\n\t\t\tonDragComplete={onDragComplete}\n\t\t\tonHover={onHover}\n\t\t\tonUnHover={onUnHover}\n\n\t\t\tdrawOn={[\"mousemove\", \"mouseleave\", \"pan\", \"drag\"]}\n\t\t/>;\n\t}\n}\n\nfunction getLineCoordinates(start, endX, endY, text) {\n\tconst end = [\n\t\tendX,\n\t\tendY\n\t];\n\treturn {\n\t\tstart, end, text\n\t};\n}\n\nfunction helper(props, moreProps) {\n\tconst { startXY, endXY } = props;\n\n\tconst {\n\t\txScale,\n\t\tchartConfig: { yScale }\n\t} = moreProps;\n\tif (isNotDefined(startXY) || isNotDefined(endXY)) {\n\t\treturn [];\n\t}\n\tconst [x1, y1] = startXY;\n\tconst [x2, y2] = endXY;\n\n\tconst dx = x2 - x1;\n\tconst dy = y2 - y1;\n\n\tif (dx !== 0 && dy !== 0) {\n\t\t// console.log(\"modLine ->\", startXY, modLine, dx1, dy1)\n\t\tconst halfY = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx2,\n\t\t\ty1 + dy / 2,\n\t\t\t\"2/1\"\n\t\t);\n\t\tconst oneThirdY = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx2,\n\t\t\ty1 + dy / 3,\n\t\t\t\"3/1\"\n\t\t);\n\t\tconst oneFourthY = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx2,\n\t\t\ty1 + dy / 4,\n\t\t\t\"4/1\"\n\t\t);\n\t\tconst oneEighthY = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx2,\n\t\t\ty1 + dy / 8,\n\t\t\t\"8/1\"\n\t\t);\n\t\tconst halfX = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx1 + dx / 2,\n\t\t\ty2,\n\t\t\t\"1/2\"\n\t\t);\n\t\tconst oneThirdX = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx1 + dx / 3,\n\t\t\ty2,\n\t\t\t\"1/3\"\n\t\t);\n\t\tconst oneFourthX = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx1 + dx / 4,\n\t\t\ty2,\n\t\t\t\"1/4\"\n\t\t);\n\t\tconst oneEighthX = getLineCoordinates(\n\t\t\tstartXY,\n\t\t\tx1 + dx / 8,\n\t\t\ty2,\n\t\t\t\"1/8\"\n\t\t);\n\t\tconst lines = [\n\t\t\toneEighthX,\n\t\t\toneFourthX,\n\t\t\toneThirdX,\n\t\t\thalfX,\n\t\t\t{ start: startXY, end: endXY, text: \"1/1\" },\n\t\t\thalfY,\n\t\t\toneThirdY,\n\t\t\toneFourthY,\n\t\t\toneEighthY,\n\t\t];\n\t\tconst lineCoods = lines.map(line => {\n\t\t\tconst { x1, y1, x2, y2 } = generateLine({\n\t\t\t\ttype: \"RAY\",\n\t\t\t\tstart: line.start,\n\t\t\t\tend: line.end,\n\t\t\t\txScale,\n\t\t\t\tyScale,\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tx1: xScale(x1),\n\t\t\t\ty1: yScale(y1),\n\t\t\t\tx2: xScale(x2),\n\t\t\t\ty2: yScale(y2),\n\t\t\t\tlabel: {\n\t\t\t\t\tx: xScale(line.end[0]),\n\t\t\t\t\ty: yScale(line.end[1]),\n\t\t\t\t\ttext: line.text\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t\treturn lineCoods;\n\t}\n\treturn [];\n}\n\n\nGannFan.propTypes = {\n\tinteractiveCursorClass: PropTypes.string,\n\tstroke: PropTypes.string.isRequired,\n\tstrokeWidth: PropTypes.number.isRequired,\n\tfill: PropTypes.arrayOf(PropTypes.string).isRequired,\n\tstrokeOpacity: PropTypes.number.isRequired,\n\tfillOpacity: PropTypes.number.isRequired,\n\n\tfontFamily: PropTypes.string.isRequired,\n\tfontSize: PropTypes.number.isRequired,\n\tfontFill: PropTypes.string.isRequired,\n\n\tonDragStart: PropTypes.func.isRequired,\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n\tonHover: PropTypes.func,\n\tonUnHover: PropTypes.func,\n\n\tdefaultClassName: PropTypes.string,\n\n\ttolerance: PropTypes.number.isRequired,\n\tselected: PropTypes.bool.isRequired,\n};\n\nGannFan.defaultProps = {\n\tonDragStart: noop,\n\tonDrag: noop,\n\tonDragComplete: noop,\n\n\tstrokeWidth: 1,\n\ttolerance: 4,\n\tselected: false,\n};\n\nexport default GannFan;\n"]},"metadata":{},"sourceType":"script"}
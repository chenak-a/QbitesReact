{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _utils = require(\"../utils\");\n\nvar _utils2 = require(\"./utils\");\n\nvar _GenericComponent = require(\"../GenericComponent\");\n\nvar _GenericComponent2 = _interopRequireDefault(_GenericComponent);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar DrawingObjectSelector = function (_Component) {\n  _inherits(DrawingObjectSelector, _Component);\n\n  function DrawingObjectSelector(props) {\n    _classCallCheck(this, DrawingObjectSelector);\n\n    var _this = _possibleConstructorReturn(this, (DrawingObjectSelector.__proto__ || Object.getPrototypeOf(DrawingObjectSelector)).call(this, props));\n\n    _this.handleClick = _this.handleClick.bind(_this);\n    _this.handleDoubleClick = _this.handleDoubleClick.bind(_this);\n    _this.getInteraction = _this.getInteraction.bind(_this);\n    return _this;\n  }\n\n  _createClass(DrawingObjectSelector, [{\n    key: \"handleDoubleClick\",\n    value: function handleDoubleClick(moreProps, e) {\n      e.preventDefault();\n      var onDoubleClick = this.props.onDoubleClick;\n      var enabled = this.props.enabled;\n      if (!enabled) return;\n      var interactives = this.getInteraction(moreProps);\n      var allSelected = (0, _utils2.getSelected)(interactives); // console.log(selected, interactives)\n\n      if (allSelected.length > 0) {\n        var selected = (0, _utils.head)(allSelected);\n        var item = {\n          type: selected.type,\n          chartId: selected.chartId,\n          object: (0, _utils.head)(selected.objects)\n        };\n        var morePropsForChart = (0, _utils2.getMorePropsForChart)(moreProps, selected.chartId);\n        onDoubleClick(item, morePropsForChart);\n      }\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick(moreProps, e) {\n      e.preventDefault();\n      var onSelect = this.props.onSelect;\n      var enabled = this.props.enabled;\n      if (!enabled) return;\n      var interactives = this.getInteraction(moreProps);\n      onSelect(interactives, moreProps);\n    }\n  }, {\n    key: \"getInteraction\",\n    value: function getInteraction(moreProps) {\n      var _props = this.props,\n          getInteractiveNodes = _props.getInteractiveNodes,\n          drawingObjectMap = _props.drawingObjectMap;\n      var interactiveNodes = getInteractiveNodes();\n      var interactives = (0, _utils.mapObject)(interactiveNodes, function (each) {\n        var key = drawingObjectMap[each.type];\n        var valueArray = (0, _utils.isDefined)(key) ? each.node.props[key] : undefined;\n        var valuePresent = (0, _utils.isDefined)(valueArray) && Array.isArray(valueArray) && valueArray.length > 0;\n\n        if (valuePresent) {\n          // console.log(\"Value present for \", each.type, each.chartId);\n          var morePropsForChart = (0, _utils2.getMorePropsForChart)(moreProps, each.chartId);\n          var objects = each.node.getSelectionState(morePropsForChart);\n          return {\n            type: each.type,\n            chartId: each.chartId,\n            objects: objects\n          };\n        }\n\n        return {\n          type: each.type,\n          chartId: each.chartId,\n          objects: []\n        };\n      });\n      return interactives;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(_GenericComponent2.default, {\n        svgDraw: _utils.noop,\n        canvasToDraw: _GenericComponent.getMouseCanvas,\n        canvasDraw: _utils.noop,\n        onMouseDown: this.handleClick,\n        onDoubleClick: this.handleDoubleClick,\n        drawOn: [\"mousemove\", \"pan\", \"drag\"]\n      });\n    }\n  }]);\n\n  return DrawingObjectSelector;\n}(_react.Component);\n\nDrawingObjectSelector.propTypes = {\n  getInteractiveNodes: _propTypes2.default.func.isRequired,\n  onSelect: _propTypes2.default.func.isRequired,\n  onDoubleClick: _propTypes2.default.func.isRequired,\n  drawingObjectMap: _propTypes2.default.object.isRequired,\n  enabled: _propTypes2.default.bool.isRequired\n};\nDrawingObjectSelector.defaultProps = {\n  enabled: true,\n  onDoubleClick: _utils.noop\n};\nexports.default = DrawingObjectSelector;","map":{"version":3,"mappings":"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","names":["DrawingObjectSelector","props","_classCallCheck","_this","handleClick","bind","handleDoubleClick","getInteraction","moreProps","e","preventDefault","onDoubleClick","enabled","interactives","allSelected","length","selected","item","type","chartId","object","objects","morePropsForChart","onSelect","getInteractiveNodes","drawingObjectMap","interactiveNodes","key","each","valueArray","node","undefined","valuePresent","Array","isArray","getSelectionState","_react2","svgDraw","canvasToDraw","canvasDraw","onMouseDown","drawOn","propTypes","_propTypes2","func","isRequired","bool","defaultProps"],"sources":["../../../src/lib/interactive/DrawingObjectSelector.js"],"sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, noop, mapObject, head } from \"../utils\";\nimport { getMorePropsForChart, getSelected } from \"./utils\";\n\nimport GenericComponent, { getMouseCanvas } from \"../GenericComponent\";\n\nclass DrawingObjectSelector extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.handleDoubleClick = this.handleDoubleClick.bind(this);\n\t\tthis.getInteraction = this.getInteraction.bind(this);\n\t}\n\thandleDoubleClick(moreProps, e) {\n\t\te.preventDefault();\n\t\tconst { onDoubleClick } = this.props;\n\t\tconst { enabled } = this.props;\n\t\tif (!enabled) return;\n\n\t\tconst interactives = this.getInteraction(moreProps);\n\t\tconst allSelected = getSelected(interactives);\n\n\t\t// console.log(selected, interactives)\n\t\tif (allSelected.length > 0) {\n\t\t\tconst selected = head(allSelected);\n\t\t\tconst item = {\n\t\t\t\ttype: selected.type,\n\t\t\t\tchartId: selected.chartId,\n\t\t\t\tobject: head(selected.objects)\n\t\t\t};\n\t\t\tconst morePropsForChart = getMorePropsForChart(\n\t\t\t\tmoreProps, selected.chartId\n\t\t\t);\n\t\t\tonDoubleClick(item, morePropsForChart);\n\t\t}\n\t}\n\thandleClick(moreProps, e) {\n\t\te.preventDefault();\n\t\tconst { onSelect } = this.props;\n\t\tconst { enabled } = this.props;\n\t\tif (!enabled) return;\n\n\t\tconst interactives = this.getInteraction(moreProps);\n\n\t\tonSelect(interactives, moreProps);\n\t}\n\tgetInteraction(moreProps) {\n\t\tconst { getInteractiveNodes, drawingObjectMap } = this.props;\n\t\tconst interactiveNodes = getInteractiveNodes();\n\t\tconst interactives = mapObject(interactiveNodes, each => {\n\t\t\tconst key = drawingObjectMap[each.type];\n\n\t\t\tconst valueArray = isDefined(key)\n\t\t\t\t? each.node.props[key]\n\t\t\t\t: undefined;\n\n\t\t\tconst valuePresent = isDefined(valueArray)\n\t\t\t\t&& Array.isArray(valueArray)\n\t\t\t\t&& valueArray.length > 0;\n\t\t\tif (valuePresent) {\n\t\t\t\t// console.log(\"Value present for \", each.type, each.chartId);\n\t\t\t\tconst morePropsForChart = getMorePropsForChart(\n\t\t\t\t\tmoreProps, each.chartId\n\t\t\t\t);\n\n\t\t\t\tconst objects = each.node.getSelectionState(morePropsForChart);\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: each.type,\n\t\t\t\t\tchartId: each.chartId,\n\t\t\t\t\tobjects,\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\ttype: each.type,\n\t\t\t\tchartId: each.chartId,\n\t\t\t\tobjects: [],\n\t\t\t};\n\t\t});\n\n\t\treturn interactives;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<GenericComponent\n\t\t\t\tsvgDraw={noop}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tcanvasDraw={noop}\n\n\t\t\t\tonMouseDown={this.handleClick}\n\t\t\t\tonDoubleClick={this.handleDoubleClick}\n\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\n\t\t\t/>\n\t\t);\n\t}\n}\n\n\nDrawingObjectSelector.propTypes = {\n\tgetInteractiveNodes: PropTypes.func.isRequired,\n\tonSelect: PropTypes.func.isRequired,\n\tonDoubleClick: PropTypes.func.isRequired,\n\tdrawingObjectMap: PropTypes.object.isRequired,\n\tenabled: PropTypes.bool.isRequired,\n};\n\nDrawingObjectSelector.defaultProps = {\n\tenabled: true,\n\tonDoubleClick: noop,\n};\n\nexport default DrawingObjectSelector;\n"]},"metadata":{},"sourceType":"script"}
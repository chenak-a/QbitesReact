{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _d3Collection = require(\"d3-collection\");\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _GenericChartComponent = require(\"../GenericChartComponent\");\n\nvar _GenericChartComponent2 = _interopRequireDefault(_GenericChartComponent);\n\nvar _GenericComponent = require(\"../GenericComponent\");\n\nvar _utils = require(\"../utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar OHLCSeries = function (_Component) {\n  _inherits(OHLCSeries, _Component);\n\n  function OHLCSeries(props) {\n    _classCallCheck(this, OHLCSeries);\n\n    var _this = _possibleConstructorReturn(this, (OHLCSeries.__proto__ || Object.getPrototypeOf(OHLCSeries)).call(this, props));\n\n    _this.renderSVG = _this.renderSVG.bind(_this);\n    _this.drawOnCanvas = _this.drawOnCanvas.bind(_this);\n    return _this;\n  }\n\n  _createClass(OHLCSeries, [{\n    key: \"drawOnCanvas\",\n    value: function drawOnCanvas(ctx, moreProps) {\n      var yAccessor = this.props.yAccessor;\n      var xAccessor = moreProps.xAccessor;\n      var xScale = moreProps.xScale,\n          yScale = moreProps.chartConfig.yScale,\n          plotData = moreProps.plotData;\n      var barData = getOHLCBars(this.props, xAccessor, yAccessor, xScale, yScale, plotData);\n\n      _drawOnCanvas(ctx, barData);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var clip = this.props.clip;\n      return _react2.default.createElement(_GenericChartComponent2.default, {\n        svgDraw: this.renderSVG,\n        canvasToDraw: _GenericComponent.getAxisCanvas,\n        canvasDraw: this.drawOnCanvas,\n        clip: clip,\n        drawOn: [\"pan\"]\n      });\n    }\n  }, {\n    key: \"renderSVG\",\n    value: function renderSVG(moreProps) {\n      var _props = this.props,\n          className = _props.className,\n          yAccessor = _props.yAccessor;\n      var xAccessor = moreProps.xAccessor;\n      var xScale = moreProps.xScale,\n          yScale = moreProps.chartConfig.yScale,\n          plotData = moreProps.plotData;\n      var barData = getOHLCBars(this.props, xAccessor, yAccessor, xScale, yScale, plotData);\n      var strokeWidth = barData.strokeWidth,\n          bars = barData.bars;\n      return _react2.default.createElement(\"g\", {\n        className: className\n      }, bars.map(function (d, idx) {\n        return _react2.default.createElement(\"path\", {\n          key: idx,\n          className: d.className,\n          stroke: d.stroke,\n          strokeWidth: strokeWidth,\n          d: \"M\" + d.openX1 + \" \" + d.openY + \" L\" + d.openX2 + \" \" + d.openY + \" M\" + d.x + \" \" + d.y1 + \" L\" + d.x + \" \" + d.y2 + \" M\" + d.closeX1 + \" \" + d.closeY + \" L\" + d.closeX2 + \" \" + d.closeY\n        });\n      }));\n    }\n  }]);\n\n  return OHLCSeries;\n}(_react.Component);\n\nOHLCSeries.propTypes = {\n  className: _propTypes2.default.string,\n  classNames: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string]).isRequired,\n  stroke: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string]).isRequired,\n  yAccessor: _propTypes2.default.func.isRequired,\n  clip: _propTypes2.default.bool.isRequired\n};\nOHLCSeries.defaultProps = {\n  className: \"react-stockcharts-ohlc\",\n  yAccessor: function yAccessor(d) {\n    return {\n      open: d.open,\n      high: d.high,\n      low: d.low,\n      close: d.close\n    };\n  },\n  classNames: function classNames(d) {\n    return (0, _utils.isDefined)(d.absoluteChange) ? d.absoluteChange > 0 ? \"up\" : \"down\" : \"firstbar\";\n  },\n  stroke: function stroke(d) {\n    return (0, _utils.isDefined)(d.absoluteChange) ? d.absoluteChange > 0 ? \"#6BA583\" : \"#FF0000\" : \"#000000\";\n  },\n  clip: true\n};\n\nfunction _drawOnCanvas(ctx, barData) {\n  var strokeWidth = barData.strokeWidth,\n      bars = barData.bars;\n  var wickNest = (0, _d3Collection.nest)().key(function (d) {\n    return d.stroke;\n  }).entries(bars);\n  ctx.lineWidth = strokeWidth;\n  wickNest.forEach(function (outer) {\n    var key = outer.key,\n        values = outer.values;\n    ctx.strokeStyle = key;\n    values.forEach(function (d) {\n      ctx.beginPath();\n      ctx.moveTo(d.x, d.y1);\n      ctx.lineTo(d.x, d.y2);\n      ctx.moveTo(d.openX1, d.openY);\n      ctx.lineTo(d.openX2, d.openY);\n      ctx.moveTo(d.closeX1, d.closeY);\n      ctx.lineTo(d.closeX2, d.closeY);\n      ctx.stroke();\n    });\n  });\n}\n\nfunction getOHLCBars(props, xAccessor, yAccessor, xScale, yScale, plotData) {\n  var classNamesProp = props.classNames,\n      strokeProp = props.stroke;\n  var strokeFunc = (0, _utils.functor)(strokeProp);\n  var classNameFunc = (0, _utils.functor)(classNamesProp);\n  var width = xScale(xAccessor(plotData[plotData.length - 1])) - xScale(xAccessor(plotData[0]));\n  var barWidth = Math.max(1, Math.round(width / (plotData.length - 1) / 2) - 1.5);\n  var strokeWidth = Math.min(barWidth, 6);\n  var bars = plotData.filter(function (d) {\n    return (0, _utils.isDefined)(yAccessor(d).close);\n  }).map(function (d) {\n    var ohlc = yAccessor(d),\n        x = Math.round(xScale(xAccessor(d))),\n        y1 = yScale(ohlc.high),\n        y2 = yScale(ohlc.low),\n        openX1 = x - barWidth,\n        openX2 = x + strokeWidth / 2,\n        openY = yScale(ohlc.open),\n        closeX1 = x - strokeWidth / 2,\n        closeX2 = x + barWidth,\n        closeY = yScale(ohlc.close),\n        className = classNameFunc(d),\n        stroke = strokeFunc(d);\n    return {\n      x: x,\n      y1: y1,\n      y2: y2,\n      openX1: openX1,\n      openX2: openX2,\n      openY: openY,\n      closeX1: closeX1,\n      closeX2: closeX2,\n      closeY: closeY,\n      stroke: stroke,\n      className: className\n    };\n  });\n  return {\n    barWidth: barWidth,\n    strokeWidth: strokeWidth,\n    bars: bars\n  };\n}\n\nexports.default = OHLCSeries;","map":{"version":3,"mappings":"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","names":["OHLCSeries","props","_classCallCheck","_this","renderSVG","bind","drawOnCanvas","ctx","moreProps","yAccessor","xAccessor","xScale","yScale","chartConfig","plotData","barData","getOHLCBars","clip","_react2","svgDraw","canvasToDraw","canvasDraw","drawOn","className","strokeWidth","bars","map","d","idx","key","stroke","openX1","openY","openX2","x","y1","y2","closeX1","closeY","closeX2","propTypes","_propTypes2","string","classNames","oneOfType","func","isRequired","bool","defaultProps","open","high","low","close","absoluteChange","wickNest","entries","lineWidth","forEach","outer","values","strokeStyle","beginPath","moveTo","lineTo","classNamesProp","strokeProp","strokeFunc","classNameFunc","width","length","barWidth","Math","max","round","min","filter","ohlc"],"sources":["../../../src/lib/series/OHLCSeries.js"],"sourcesContent":["\n\nimport { nest } from \"d3-collection\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas } from \"../GenericComponent\";\n\nimport { isDefined, functor } from \"../utils\";\n\nclass OHLCSeries extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { yAccessor } = this.props;\n\t\tconst { xAccessor } = moreProps;\n\t\tconst { xScale, chartConfig: { yScale }, plotData } = moreProps;\n\n\t\tconst barData = getOHLCBars(this.props, xAccessor, yAccessor, xScale, yScale, plotData);\n\t\tdrawOnCanvas(ctx, barData);\n\t}\n\trender() {\n\t\tconst { clip } = this.props;\n\n\t\treturn <GenericChartComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasToDraw={getAxisCanvas}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tclip={clip}\n\t\t\tdrawOn={[\"pan\"]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className, yAccessor } = this.props;\n\t\tconst { xAccessor } = moreProps;\n\t\tconst { xScale, chartConfig: { yScale }, plotData } = moreProps;\n\n\n\t\tconst barData = getOHLCBars(this.props, xAccessor, yAccessor, xScale, yScale, plotData);\n\n\t\tconst { strokeWidth, bars } = barData;\n\n\t\treturn <g className={className}>\n\t\t\t{bars.map((d, idx) => <path key={idx}\n\t\t\t\tclassName={d.className} stroke={d.stroke} strokeWidth={strokeWidth}\n\t\t\t\td={`M${d.openX1} ${d.openY} L${d.openX2} ${d.openY} M${d.x} ${d.y1} L${d.x} ${d.y2} M${d.closeX1} ${d.closeY} L${d.closeX2} ${d.closeY}`}/>)}\n\t\t</g>;\n\t}\n}\n\nOHLCSeries.propTypes = {\n\tclassName: PropTypes.string,\n\tclassNames: PropTypes.oneOfType([\n\t\tPropTypes.func,\n\t\tPropTypes.string\n\t]).isRequired,\n\tstroke: PropTypes.oneOfType([\n\t\tPropTypes.func,\n\t\tPropTypes.string\n\t]).isRequired,\n\tyAccessor: PropTypes.func.isRequired,\n\tclip: PropTypes.bool.isRequired,\n};\n\nOHLCSeries.defaultProps = {\n\tclassName: \"react-stockcharts-ohlc\",\n\tyAccessor: (d) => ({ open: d.open, high: d.high, low: d.low, close: d.close }),\n\tclassNames: d => isDefined(d.absoluteChange) ? (d.absoluteChange > 0 ? \"up\" : \"down\") : \"firstbar\",\n\tstroke: d => isDefined(d.absoluteChange) ? (d.absoluteChange > 0 ? \"#6BA583\" : \"#FF0000\") : \"#000000\",\n\tclip: true,\n};\n\nfunction drawOnCanvas(ctx, barData) {\n\n\tconst { strokeWidth, bars } = barData;\n\n\tconst wickNest = nest()\n\t\t.key(d => d.stroke)\n\t\t.entries(bars);\n\n\tctx.lineWidth = strokeWidth;\n\n\twickNest.forEach(outer => {\n\t\tconst { key, values } = outer;\n\t\tctx.strokeStyle = key;\n\t\tvalues.forEach(d => {\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(d.x, d.y1);\n\t\t\tctx.lineTo(d.x, d.y2);\n\n\t\t\tctx.moveTo(d.openX1, d.openY);\n\t\t\tctx.lineTo(d.openX2, d.openY);\n\n\t\t\tctx.moveTo(d.closeX1, d.closeY);\n\t\t\tctx.lineTo(d.closeX2, d.closeY);\n\n\t\t\tctx.stroke();\n\t\t});\n\t});\n}\n\nfunction getOHLCBars(props, xAccessor, yAccessor, xScale, yScale, plotData) {\n\tconst { classNames: classNamesProp, stroke: strokeProp } = props;\n\n\tconst strokeFunc = functor(strokeProp);\n\tconst classNameFunc = functor(classNamesProp);\n\n\tconst width = xScale(xAccessor(plotData[plotData.length - 1]))\n\t\t- xScale(xAccessor(plotData[0]));\n\n\tconst barWidth = Math.max(1, Math.round(width / (plotData.length - 1) / 2) - 1.5);\n\tconst strokeWidth = Math.min(barWidth, 6);\n\n\tconst bars = plotData\n\t\t.filter(d => isDefined(yAccessor(d).close))\n\t\t.map(d => {\n\t\t\tconst ohlc = yAccessor(d),\n\t\t\t\tx = Math.round(xScale(xAccessor(d))),\n\t\t\t\ty1 = yScale(ohlc.high),\n\t\t\t\ty2 = yScale(ohlc.low),\n\t\t\t\topenX1 = x - barWidth,\n\t\t\t\topenX2 = x + strokeWidth / 2,\n\t\t\t\topenY = yScale(ohlc.open),\n\t\t\t\tcloseX1 = x - strokeWidth / 2,\n\t\t\t\tcloseX2 = x + barWidth,\n\t\t\t\tcloseY = yScale(ohlc.close),\n\t\t\t\tclassName = classNameFunc(d),\n\t\t\t\tstroke = strokeFunc(d);\n\n\t\t\treturn { x, y1, y2, openX1, openX2, openY, closeX1, closeX2, closeY, stroke, className };\n\t\t});\n\treturn { barWidth, strokeWidth, bars };\n}\n\nexport default OHLCSeries;\n"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _d3Selection = require(\"d3-selection\");\n\nvar _d3Array = require(\"d3-array\");\n\nvar _utils = require(\"../utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar AxisZoomCapture = function (_Component) {\n  _inherits(AxisZoomCapture, _Component);\n\n  function AxisZoomCapture(props) {\n    _classCallCheck(this, AxisZoomCapture);\n\n    var _this = _possibleConstructorReturn(this, (AxisZoomCapture.__proto__ || Object.getPrototypeOf(AxisZoomCapture)).call(this, props));\n\n    _this.handleDragStartMouse = _this.handleDragStartMouse.bind(_this);\n    _this.handleDragStartTouch = _this.handleDragStartTouch.bind(_this);\n    _this.handleDrag = _this.handleDrag.bind(_this);\n    _this.handleDragEnd = _this.handleDragEnd.bind(_this);\n    _this.handleRightClick = _this.handleRightClick.bind(_this);\n    _this.saveNode = _this.saveNode.bind(_this);\n    _this.state = {\n      startPosition: null\n    };\n    return _this;\n  }\n\n  _createClass(AxisZoomCapture, [{\n    key: \"saveNode\",\n    value: function saveNode(node) {\n      this.node = node;\n    }\n  }, {\n    key: \"handleRightClick\",\n    value: function handleRightClick(e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var onContextMenu = this.props.onContextMenu;\n      var mouseXY = (0, _utils.mousePosition)(e, this.node.getBoundingClientRect());\n      (0, _d3Selection.select)((0, _utils.d3Window)(this.node)).on(_utils.MOUSEMOVE, null).on(_utils.MOUSEUP, null);\n      this.setState({\n        startPosition: null\n      });\n      onContextMenu(mouseXY, e);\n      this.contextMenuClicked = true;\n    }\n  }, {\n    key: \"handleDragStartMouse\",\n    value: function handleDragStartMouse(e) {\n      this.mouseInteraction = true;\n      var _props = this.props,\n          getScale = _props.getScale,\n          getMoreProps = _props.getMoreProps;\n      var startScale = getScale(getMoreProps());\n      this.dragHappened = false;\n\n      if (startScale.invert) {\n        (0, _d3Selection.select)((0, _utils.d3Window)(this.node)).on(_utils.MOUSEMOVE, this.handleDrag, false).on(_utils.MOUSEUP, this.handleDragEnd, false);\n        var startXY = (0, _utils.mousePosition)(e);\n        this.setState({\n          startPosition: {\n            startXY: startXY,\n            startScale: startScale\n          }\n        });\n      }\n\n      e.preventDefault();\n    }\n  }, {\n    key: \"handleDragStartTouch\",\n    value: function handleDragStartTouch(e) {\n      this.mouseInteraction = false;\n      var _props2 = this.props,\n          getScale = _props2.getScale,\n          getMoreProps = _props2.getMoreProps;\n      var startScale = getScale(getMoreProps());\n      this.dragHappened = false;\n\n      if (e.touches.length === 1 && startScale.invert) {\n        (0, _d3Selection.select)((0, _utils.d3Window)(this.node)).on(_utils.TOUCHMOVE, this.handleDrag).on(_utils.TOUCHEND, this.handleDragEnd);\n        var startXY = (0, _utils.touchPosition)((0, _utils.getTouchProps)(e.touches[0]), e);\n        this.setState({\n          startPosition: {\n            startXY: startXY,\n            startScale: startScale\n          }\n        });\n      }\n    }\n  }, {\n    key: \"handleDrag\",\n    value: function handleDrag() {\n      var startPosition = this.state.startPosition;\n      var _props3 = this.props,\n          getMouseDelta = _props3.getMouseDelta,\n          inverted = _props3.inverted;\n      this.dragHappened = true;\n\n      if ((0, _utils.isDefined)(startPosition)) {\n        var startScale = startPosition.startScale;\n        var startXY = startPosition.startXY;\n        var mouseXY = this.mouseInteraction ? (0, _d3Selection.mouse)(this.node) : (0, _d3Selection.touches)(this.node)[0];\n        var diff = getMouseDelta(startXY, mouseXY);\n        var center = (0, _d3Array.mean)(startScale.range());\n        var tempRange = startScale.range().map(function (d) {\n          return inverted ? d - (0, _utils.sign)(d - center) * diff : d + (0, _utils.sign)(d - center) * diff;\n        });\n        var newDomain = tempRange.map(startScale.invert);\n\n        if ((0, _utils.sign)((0, _utils.last)(startScale.range()) - (0, _utils.first)(startScale.range())) === (0, _utils.sign)((0, _utils.last)(tempRange) - (0, _utils.first)(tempRange))) {\n          var axisZoomCallback = this.props.axisZoomCallback; // console.log(startXScale.domain(), newXDomain)\n\n          axisZoomCallback(newDomain);\n        }\n      }\n    }\n  }, {\n    key: \"handleDragEnd\",\n    value: function handleDragEnd() {\n      var _this2 = this;\n\n      if (!this.dragHappened) {\n        if (this.clicked) {\n          var e = _d3Selection.event;\n          var mouseXY = this.mouseInteraction ? (0, _d3Selection.mouse)(this.node) : (0, _d3Selection.touches)(this.node)[0];\n          var onDoubleClick = this.props.onDoubleClick;\n          onDoubleClick(mouseXY, e);\n        } else {\n          this.clicked = true;\n          setTimeout(function () {\n            _this2.clicked = false;\n          }, 300);\n        }\n      }\n\n      (0, _d3Selection.select)((0, _utils.d3Window)(this.node)).on(_utils.MOUSEMOVE, null).on(_utils.MOUSEUP, null).on(_utils.TOUCHMOVE, null).on(_utils.TOUCHEND, null);\n      this.setState({\n        startPosition: null\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props4 = this.props,\n          bg = _props4.bg,\n          className = _props4.className,\n          zoomCursorClassName = _props4.zoomCursorClassName;\n      var cursor = (0, _utils.isDefined)(this.state.startPosition) ? zoomCursorClassName : \"react-stockcharts-default-cursor\";\n      return _react2.default.createElement(\"rect\", {\n        className: \"react-stockcharts-enable-interaction \" + cursor + \" \" + className,\n        ref: this.saveNode,\n        x: bg.x,\n        y: bg.y,\n        opacity: 0,\n        height: bg.h,\n        width: bg.w,\n        onContextMenu: this.handleRightClick,\n        onMouseDown: this.handleDragStartMouse,\n        onTouchStart: this.handleDragStartTouch\n      });\n    }\n  }]);\n\n  return AxisZoomCapture;\n}(_react.Component);\n\nAxisZoomCapture.propTypes = {\n  innerTickSize: _propTypes2.default.number,\n  outerTickSize: _propTypes2.default.number,\n  tickFormat: _propTypes2.default.func,\n  tickPadding: _propTypes2.default.number,\n  tickSize: _propTypes2.default.number,\n  ticks: _propTypes2.default.number,\n  tickValues: _propTypes2.default.array,\n  showDomain: _propTypes2.default.bool,\n  showTicks: _propTypes2.default.bool,\n  className: _propTypes2.default.string,\n  axisZoomCallback: _propTypes2.default.func,\n  inverted: _propTypes2.default.bool,\n  bg: _propTypes2.default.object.isRequired,\n  zoomCursorClassName: _propTypes2.default.string.isRequired,\n  getMoreProps: _propTypes2.default.func.isRequired,\n  getScale: _propTypes2.default.func.isRequired,\n  getMouseDelta: _propTypes2.default.func.isRequired,\n  onDoubleClick: _propTypes2.default.func.isRequired,\n  onContextMenu: _propTypes2.default.func.isRequired\n};\nAxisZoomCapture.defaultProps = {\n  onDoubleClick: _utils.noop,\n  onContextMenu: _utils.noop,\n  inverted: true\n};\nexports.default = AxisZoomCapture;","map":{"version":3,"mappings":"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","names":["AxisZoomCapture","props","_classCallCheck","_this","handleDragStartMouse","bind","handleDragStartTouch","handleDrag","handleDragEnd","handleRightClick","saveNode","state","startPosition","node","e","stopPropagation","preventDefault","onContextMenu","mouseXY","getBoundingClientRect","on","setState","contextMenuClicked","mouseInteraction","getScale","getMoreProps","startScale","dragHappened","invert","startXY","touches","length","getMouseDelta","inverted","diff","center","range","tempRange","map","d","newDomain","axisZoomCallback","clicked","onDoubleClick","setTimeout","_this2","bg","className","zoomCursorClassName","cursor","_react2","ref","x","y","opacity","height","h","width","w","onMouseDown","onTouchStart","propTypes","innerTickSize","_propTypes2","number","outerTickSize","tickFormat","func","tickPadding","tickSize","ticks","tickValues","array","showDomain","bool","showTicks","string","object","isRequired","defaultProps"],"sources":["../../../src/lib/axes/AxisZoomCapture.js"],"sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { select, event as d3Event, mouse, touches } from \"d3-selection\";\nimport { mean } from \"d3-array\";\n\nimport {\n\tfirst,\n\tlast,\n\tisDefined,\n\tnoop,\n\tmousePosition,\n\td3Window,\n\tMOUSEMOVE,\n\tMOUSEUP,\n\tTOUCHMOVE,\n\tTOUCHEND,\n\ttouchPosition,\n\tgetTouchProps,\n\tsign,\n} from \"../utils\";\n\nclass AxisZoomCapture extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleDragStartMouse = this.handleDragStartMouse.bind(this);\n\t\tthis.handleDragStartTouch = this.handleDragStartTouch.bind(this);\n\t\tthis.handleDrag = this.handleDrag.bind(this);\n\t\tthis.handleDragEnd = this.handleDragEnd.bind(this);\n\t\tthis.handleRightClick = this.handleRightClick.bind(this);\n\t\tthis.saveNode = this.saveNode.bind(this);\n\t\tthis.state = {\n\t\t\tstartPosition: null\n\t\t};\n\t}\n\tsaveNode(node) {\n\t\tthis.node = node;\n\t}\n\thandleRightClick(e) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tconst { onContextMenu } = this.props;\n\n\t\tconst mouseXY = mousePosition(e, this.node.getBoundingClientRect());\n\n\t\tselect(d3Window(this.node))\n\t\t\t.on(MOUSEMOVE, null)\n\t\t\t.on(MOUSEUP, null);\n\t\tthis.setState({\n\t\t\tstartPosition: null,\n\t\t});\n\n\t\tonContextMenu(mouseXY, e);\n\n\t\tthis.contextMenuClicked = true;\n\t}\n\thandleDragStartMouse(e) {\n\t\tthis.mouseInteraction = true;\n\n\t\tconst { getScale, getMoreProps } = this.props;\n\t\tconst startScale = getScale(getMoreProps());\n\t\tthis.dragHappened = false;\n\n\t\tif (startScale.invert) {\n\t\t\tselect(d3Window(this.node))\n\t\t\t\t.on(MOUSEMOVE, this.handleDrag, false)\n\t\t\t\t.on(MOUSEUP, this.handleDragEnd, false);\n\n\t\t\tconst startXY = mousePosition(e);\n\n\t\t\tthis.setState({\n\t\t\t\tstartPosition: {\n\t\t\t\t\tstartXY,\n\t\t\t\t\tstartScale,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\te.preventDefault();\n\t}\n\thandleDragStartTouch(e) {\n\t\tthis.mouseInteraction = false;\n\n\t\tconst { getScale, getMoreProps } = this.props;\n\t\tconst startScale = getScale(getMoreProps());\n\t\tthis.dragHappened = false;\n\n\t\tif (e.touches.length === 1 && startScale.invert) {\n\t\t\tselect(d3Window(this.node))\n\t\t\t\t.on(TOUCHMOVE, this.handleDrag)\n\t\t\t\t.on(TOUCHEND, this.handleDragEnd);\n\n\t\t\tconst startXY = touchPosition(getTouchProps(e.touches[0]), e);\n\n\t\t\tthis.setState({\n\t\t\t\tstartPosition: {\n\t\t\t\t\tstartXY,\n\t\t\t\t\tstartScale,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\thandleDrag() {\n\t\tconst { startPosition } = this.state;\n\t\tconst { getMouseDelta, inverted } = this.props;\n\n\t\tthis.dragHappened = true;\n\t\tif (isDefined(startPosition)) {\n\t\t\tconst { startScale } = startPosition;\n\t\t\tconst { startXY } = startPosition;\n\n\t\t\tconst mouseXY = this.mouseInteraction\n\t\t\t\t? mouse(this.node)\n\t\t\t\t: touches(this.node)[0];\n\n\t\t\tconst diff = getMouseDelta(startXY, mouseXY);\n\n\t\t\tconst center = mean(startScale.range());\n\n\t\t\tconst tempRange = startScale.range()\n\t\t\t\t.map(d => inverted ? d - sign(d - center) * diff : d + sign(d - center) * diff);\n\n\t\t\tconst newDomain = tempRange.map(startScale.invert);\n\n\t\t\tif (sign(last(startScale.range()) - first(startScale.range())) === sign(last(tempRange) - first(tempRange))) {\n\n\t\t\t\tconst { axisZoomCallback } = this.props;\n\t\t\t\t// console.log(startXScale.domain(), newXDomain)\n\t\t\t\taxisZoomCallback(newDomain);\n\t\t\t}\n\t\t}\n\t}\n\thandleDragEnd() {\n\n\t\tif (!this.dragHappened) {\n\t\t\tif (this.clicked) {\n\t\t\t\tconst e = d3Event;\n\t\t\t\tconst mouseXY = this.mouseInteraction\n\t\t\t\t\t? mouse(this.node)\n\t\t\t\t\t: touches(this.node)[0];\n\t\t\t\tconst { onDoubleClick } = this.props;\n\n\t\t\t\tonDoubleClick(mouseXY, e);\n\t\t\t} else {\n\t\t\t\tthis.clicked = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.clicked = false;\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t}\n\n\t\tselect(d3Window(this.node))\n\t\t\t.on(MOUSEMOVE, null)\n\t\t\t.on(MOUSEUP, null)\n\t\t\t.on(TOUCHMOVE, null)\n\t\t\t.on(TOUCHEND, null);\n\n\t\tthis.setState({\n\t\t\tstartPosition: null,\n\t\t});\n\t}\n\trender() {\n\t\tconst { bg, className, zoomCursorClassName } = this.props;\n\n\t\tconst cursor = isDefined(this.state.startPosition)\n\t\t\t? zoomCursorClassName\n\t\t\t: \"react-stockcharts-default-cursor\";\n\n\t\treturn <rect\n\t\t\tclassName={`react-stockcharts-enable-interaction ${cursor} ${className}`}\n\t\t\tref={this.saveNode}\n\t\t\tx={bg.x} y={bg.y} opacity={0} height={bg.h} width={bg.w}\n\t\t\tonContextMenu={this.handleRightClick}\n\t\t\tonMouseDown={this.handleDragStartMouse}\n\t\t\tonTouchStart={this.handleDragStartTouch}\n\t\t/>;\n\t}\n}\n\nAxisZoomCapture.propTypes = {\n\tinnerTickSize: PropTypes.number,\n\touterTickSize: PropTypes.number,\n\ttickFormat: PropTypes.func,\n\ttickPadding: PropTypes.number,\n\ttickSize: PropTypes.number,\n\tticks: PropTypes.number,\n\ttickValues: PropTypes.array,\n\tshowDomain: PropTypes.bool,\n\tshowTicks: PropTypes.bool,\n\tclassName: PropTypes.string,\n\taxisZoomCallback: PropTypes.func,\n\tinverted: PropTypes.bool,\n\tbg: PropTypes.object.isRequired,\n\tzoomCursorClassName: PropTypes.string.isRequired,\n\tgetMoreProps: PropTypes.func.isRequired,\n\tgetScale: PropTypes.func.isRequired,\n\tgetMouseDelta: PropTypes.func.isRequired,\n\tonDoubleClick: PropTypes.func.isRequired,\n\tonContextMenu: PropTypes.func.isRequired,\n};\n\nAxisZoomCapture.defaultProps = {\n\tonDoubleClick: noop,\n\tonContextMenu: noop,\n\tinverted: true\n};\n\nexport default AxisZoomCapture;\n"]},"metadata":{},"sourceType":"script"}
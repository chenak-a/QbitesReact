{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _d3Array = require(\"d3-array\");\n\nvar _d3Collection = require(\"d3-collection\");\n\nvar _d3Scale = require(\"d3-scale\");\n\nvar _GenericChartComponent = require(\"../GenericChartComponent\");\n\nvar _GenericChartComponent2 = _interopRequireDefault(_GenericChartComponent);\n\nvar _GenericComponent = require(\"../GenericComponent\");\n\nvar _utils = require(\"../utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar VolumeProfileSeries = function (_Component) {\n  _inherits(VolumeProfileSeries, _Component);\n\n  function VolumeProfileSeries(props) {\n    _classCallCheck(this, VolumeProfileSeries);\n\n    var _this = _possibleConstructorReturn(this, (VolumeProfileSeries.__proto__ || Object.getPrototypeOf(VolumeProfileSeries)).call(this, props));\n\n    _this.renderSVG = _this.renderSVG.bind(_this);\n    _this.drawOnCanvas = _this.drawOnCanvas.bind(_this);\n    return _this;\n  }\n\n  _createClass(VolumeProfileSeries, [{\n    key: \"drawOnCanvas\",\n    value: function drawOnCanvas(ctx, moreProps) {\n      var xAccessor = moreProps.xAccessor,\n          width = moreProps.width;\n\n      var _helper = helper(this.props, moreProps, xAccessor, width),\n          rects = _helper.rects,\n          sessionBg = _helper.sessionBg;\n\n      _drawOnCanvas(ctx, this.props, rects, sessionBg);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(_GenericChartComponent2.default, {\n        svgDraw: this.renderSVG,\n        canvasDraw: this.drawOnCanvas,\n        canvasToDraw: _GenericComponent.getAxisCanvas,\n        drawOn: [\"pan\"]\n      });\n    }\n  }, {\n    key: \"renderSVG\",\n    value: function renderSVG(moreProps) {\n      var _props = this.props,\n          className = _props.className,\n          opacity = _props.opacity;\n      var _props2 = this.props,\n          showSessionBackground = _props2.showSessionBackground,\n          sessionBackGround = _props2.sessionBackGround,\n          sessionBackGroundOpacity = _props2.sessionBackGroundOpacity;\n      var xAccessor = moreProps.xAccessor,\n          width = moreProps.width;\n\n      var _helper2 = helper(this.props, moreProps, xAccessor, width),\n          rects = _helper2.rects,\n          sessionBg = _helper2.sessionBg;\n\n      var sessionBgSvg = showSessionBackground ? sessionBg.map(function (d, idx) {\n        return _react2.default.createElement(\"rect\", _extends({\n          key: idx\n        }, d, {\n          opacity: sessionBackGroundOpacity,\n          fill: sessionBackGround\n        }));\n      }) : null;\n      return _react2.default.createElement(\"g\", {\n        className: className\n      }, sessionBgSvg, rects.map(function (d, i) {\n        return _react2.default.createElement(\"g\", {\n          key: i\n        }, _react2.default.createElement(\"rect\", {\n          x: d.x,\n          y: d.y,\n          width: d.w1,\n          height: d.height,\n          fill: d.fill1,\n          stroke: d.stroke1,\n          fillOpacity: opacity\n        }), _react2.default.createElement(\"rect\", {\n          x: d.x + d.w1,\n          y: d.y,\n          width: d.w2,\n          height: d.height,\n          fill: d.fill2,\n          stroke: d.stroke2,\n          fillOpacity: opacity\n        }));\n      }));\n    }\n  }]);\n\n  return VolumeProfileSeries;\n}(_react.Component);\n\nVolumeProfileSeries.propTypes = {\n  className: _propTypes2.default.string,\n  opacity: _propTypes2.default.number,\n  showSessionBackground: _propTypes2.default.bool,\n  sessionBackGround: _propTypes2.default.string,\n  sessionBackGroundOpacity: _propTypes2.default.number\n};\nVolumeProfileSeries.defaultProps = {\n  className: \"line \",\n  bins: 20,\n  opacity: 0.5,\n  maxProfileWidthPercent: 50,\n  fill: function fill(_ref) {\n    var type = _ref.type;\n    return type === \"up\" ? \"#6BA583\" : \"#FF0000\";\n  },\n  stroke: \"#FFFFFF\",\n  showSessionBackground: false,\n  sessionBackGround: \"#4682B4\",\n  sessionBackGroundOpacity: 0.3,\n  source: function source(d) {\n    return d.close;\n  },\n  volume: function volume(d) {\n    return d.volume;\n  },\n  absoluteChange: function absoluteChange(d) {\n    return d.absoluteChange;\n  },\n  bySession: false,\n\n  /* eslint-disable no-unused-vars */\n  sessionStart: function sessionStart(_ref2) {\n    var d = _ref2.d,\n        i = _ref2.i,\n        plotData = _ref2.plotData;\n    return i > 0 && plotData[i - 1].date.getMonth() !== d.date.getMonth();\n  },\n\n  /* eslint-enable no-unused-vars */\n  orient: \"left\",\n  // // fill: ({ type }) => { var c = type === \"up\" ? \"#6BA583\" : \"#FF0000\"; console.log(type, c); return c },\n  // stroke: ({ type }) =>  type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n  // stroke: \"none\",\n  partialStartOK: true,\n  partialEndOK: true\n};\n\nfunction helper(props, moreProps, xAccessor, width) {\n  var realXScale = moreProps.xScale,\n      yScale = moreProps.chartConfig.yScale,\n      plotData = moreProps.plotData;\n  var sessionStart = props.sessionStart,\n      bySession = props.bySession,\n      partialStartOK = props.partialStartOK,\n      partialEndOK = props.partialEndOK;\n  var bins = props.bins,\n      maxProfileWidthPercent = props.maxProfileWidthPercent,\n      source = props.source,\n      volume = props.volume,\n      absoluteChange = props.absoluteChange,\n      orient = props.orient,\n      fill = props.fill,\n      stroke = props.stroke;\n  var sessionBuilder = (0, _utils.accumulatingWindow)().discardTillStart(!partialStartOK).discardTillEnd(!partialEndOK).accumulateTill(function (d, i) {\n    return sessionStart(_extends({\n      d: d,\n      i: i\n    }, moreProps));\n  }).accumulator(_utils.identity);\n  var dx = plotData.length > 1 ? realXScale(xAccessor(plotData[1])) - realXScale(xAccessor((0, _utils.head)(plotData))) : 0;\n  var sessions = bySession ? sessionBuilder(plotData) : [plotData];\n  var allRects = sessions.map(function (session) {\n    var begin = bySession ? realXScale(xAccessor((0, _utils.head)(session))) : 0;\n    var finish = bySession ? realXScale(xAccessor((0, _utils.last)(session))) : width;\n    var sessionWidth = finish - begin + dx; // console.log(session)\n\n    /* var histogram = d3.layout.histogram()\n    \t\t.value(source)\n    \t\t.bins(bins);*/\n\n    var histogram2 = (0, _d3Array.histogram)() // .domain(xScale.domain())\n    .value(source).thresholds(bins); // console.log(bins, histogram(session))\n    // console.log(bins, histogram2(session))\n\n    var rollup = (0, _d3Collection.nest)().key(function (d) {\n      return d.direction;\n    }).sortKeys(orient === \"right\" ? _d3Array.descending : _d3Array.ascending).rollup(function (leaves) {\n      return (0, _d3Array.sum)(leaves, function (d) {\n        return d.volume;\n      });\n    });\n    var values = histogram2(session); // console.log(\"values\", values)\n\n    var volumeInBins = values.map(function (arr) {\n      return arr.map(function (d) {\n        return absoluteChange(d) > 0 ? {\n          direction: \"up\",\n          volume: volume(d)\n        } : {\n          direction: \"down\",\n          volume: volume(d)\n        };\n      });\n    }).map(function (arr) {\n      return rollup.entries(arr);\n    }); // console.log(\"volumeInBins\", volumeInBins)\n\n    var volumeValues = volumeInBins.map(function (each) {\n      return (0, _d3Array.sum)(each.map(function (d) {\n        return d.value;\n      }));\n    }); // console.log(\"volumeValues\", volumeValues)\n\n    var base = function base(xScale) {\n      return (0, _utils.head)(xScale.range());\n    };\n\n    var _ref3 = orient === \"right\" ? [begin, begin + sessionWidth * maxProfileWidthPercent / 100] : [finish, finish - sessionWidth * (100 - maxProfileWidthPercent) / 100],\n        _ref4 = _slicedToArray(_ref3, 2),\n        start = _ref4[0],\n        end = _ref4[1];\n\n    var xScale = (0, _d3Scale.scaleLinear)().domain([0, (0, _d3Array.max)(volumeValues)]).range([start, end]); // console.log(xScale.domain())\n\n    var totalVolumes = volumeInBins.map(function (volumes) {\n      var totalVolume = (0, _d3Array.sum)(volumes, function (d) {\n        return d.value;\n      });\n      var totalVolumeX = xScale(totalVolume);\n      var width = base(xScale) - totalVolumeX;\n      var x = width < 0 ? totalVolumeX + width : totalVolumeX;\n      var ws = volumes.map(function (d) {\n        return {\n          type: d.key,\n          width: d.value * Math.abs(width) / totalVolume\n        };\n      });\n      return {\n        x: x,\n        ws: ws,\n        totalVolumeX: totalVolumeX\n      };\n    }); // console.log(\"totalVolumes\", totalVolumes)\n\n    var rects = (0, _d3Array.zip)(values, totalVolumes).map(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n          d = _ref6[0],\n          _ref6$ = _ref6[1],\n          x = _ref6$.x,\n          ws = _ref6$.ws;\n\n      var w1 = ws[0] || {\n        type: \"up\",\n        width: 0\n      };\n      var w2 = ws[1] || {\n        type: \"down\",\n        width: 0\n      };\n      return {\n        // y: yScale(d.x + d.dx),\n        y: yScale(d.x1),\n        // height: yScale(d.x - d.dx) - yScale(d.x),\n        height: yScale(d.x1) - yScale(d.x0),\n        x: x,\n        width: width,\n        w1: w1.width,\n        w2: w2.width,\n        stroke1: (0, _utils.functor)(stroke)(w1),\n        stroke2: (0, _utils.functor)(stroke)(w2),\n        fill1: (0, _utils.functor)(fill)(w1),\n        fill2: (0, _utils.functor)(fill)(w2)\n      };\n    }); // console.log(\"rects\", rects)\n\n    var sessionBg = {\n      x: begin,\n      y: (0, _utils.last)(rects).y,\n      height: (0, _utils.head)(rects).y - (0, _utils.last)(rects).y + (0, _utils.head)(rects).height,\n      width: sessionWidth\n    };\n    return {\n      rects: rects,\n      sessionBg: sessionBg\n    };\n  });\n  return {\n    rects: (0, _d3Array.merge)(allRects.map(function (d) {\n      return d.rects;\n    })),\n    sessionBg: allRects.map(function (d) {\n      return d.sessionBg;\n    })\n  };\n}\n\nfunction _drawOnCanvas(ctx, props, rects, sessionBg) {\n  var opacity = props.opacity,\n      sessionBackGround = props.sessionBackGround,\n      sessionBackGroundOpacity = props.sessionBackGroundOpacity,\n      showSessionBackground = props.showSessionBackground; // var { rects, sessionBg } = helper(props, xScale, yScale, plotData);\n\n  if (showSessionBackground) {\n    ctx.fillStyle = (0, _utils.hexToRGBA)(sessionBackGround, sessionBackGroundOpacity);\n    sessionBg.forEach(function (each) {\n      var x = each.x,\n          y = each.y,\n          height = each.height,\n          width = each.width;\n      ctx.beginPath();\n      ctx.rect(x, y, width, height);\n      ctx.closePath();\n      ctx.fill();\n    });\n  }\n\n  rects.forEach(function (each) {\n    var x = each.x,\n        y = each.y,\n        height = each.height,\n        w1 = each.w1,\n        w2 = each.w2,\n        stroke1 = each.stroke1,\n        stroke2 = each.stroke2,\n        fill1 = each.fill1,\n        fill2 = each.fill2;\n\n    if (w1 > 0) {\n      ctx.fillStyle = (0, _utils.hexToRGBA)(fill1, opacity);\n      if (stroke1 !== \"none\") ctx.strokeStyle = stroke1;\n      ctx.beginPath();\n      ctx.rect(x, y, w1, height);\n      ctx.closePath();\n      ctx.fill();\n      if (stroke1 !== \"none\") ctx.stroke();\n    }\n\n    if (w2 > 0) {\n      ctx.fillStyle = (0, _utils.hexToRGBA)(fill2, opacity);\n      if (stroke2 !== \"none\") ctx.strokeStyle = stroke2;\n      ctx.beginPath();\n      ctx.rect(x + w1, y, w2, height);\n      ctx.closePath();\n      ctx.fill();\n      if (stroke2 !== \"none\") ctx.stroke();\n    }\n  });\n}\n\nexports.default = VolumeProfileSeries;","map":{"version":3,"mappings":"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","names":["VolumeProfileSeries","props","_classCallCheck","_this","renderSVG","bind","drawOnCanvas","ctx","moreProps","xAccessor","width","helper","rects","sessionBg","_react2","svgDraw","canvasDraw","canvasToDraw","drawOn","className","opacity","showSessionBackground","sessionBackGround","sessionBackGroundOpacity","sessionBgSvg","map","d","idx","key","fill","i","x","y","w1","height","fill1","stroke","stroke1","fillOpacity","w2","fill2","stroke2","propTypes","_propTypes2","string","number","bool","defaultProps","bins","maxProfileWidthPercent","type","source","close","volume","absoluteChange","bySession","sessionStart","plotData","date","getMonth","orient","partialStartOK","partialEndOK","realXScale","xScale","yScale","chartConfig","sessionBuilder","discardTillStart","discardTillEnd","accumulateTill","accumulator","dx","length","sessions","allRects","begin","session","finish","sessionWidth","histogram2","value","thresholds","rollup","direction","sortKeys","leaves","values","volumeInBins","arr","entries","volumeValues","each","base","range","start","end","domain","totalVolumes","totalVolume","volumes","totalVolumeX","ws","Math","abs","x1","x0","fillStyle","forEach","beginPath","rect","closePath","strokeStyle"],"sources":["../../../src/lib/series/VolumeProfileSeries.js"],"sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { ascending, descending, sum, max, merge, zip, histogram as d3Histogram } from \"d3-array\";\nimport { nest } from \"d3-collection\";\nimport { scaleLinear } from \"d3-scale\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas } from \"../GenericComponent\";\n\nimport { head, last, hexToRGBA, accumulatingWindow, identity, functor } from \"../utils\";\n\nclass VolumeProfileSeries extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { xAccessor, width } = moreProps;\n\t\tconst { rects, sessionBg } = helper(this.props, moreProps, xAccessor, width);\n\n\t\tdrawOnCanvas(ctx, this.props, rects, sessionBg);\n\t}\n\trender() {\n\t\treturn <GenericChartComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getAxisCanvas}\n\t\t\tdrawOn={[\"pan\"]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className, opacity } = this.props;\n\t\tconst { showSessionBackground, sessionBackGround, sessionBackGroundOpacity } = this.props;\n\n\t\tconst { xAccessor, width } = moreProps;\n\t\tconst { rects, sessionBg } = helper(this.props, moreProps, xAccessor, width);\n\n\t\tconst sessionBgSvg = showSessionBackground\n\t\t\t? sessionBg.map((d, idx) => <rect key={idx} {...d} opacity={sessionBackGroundOpacity} fill={sessionBackGround} />)\n\t\t\t: null;\n\n\t\treturn <g className={className}>\n\t\t\t{sessionBgSvg}\n\t\t\t{rects.map((d, i) => <g key={i}>\n\t\t\t\t<rect x={d.x} y={d.y}\n\t\t\t\t\twidth={d.w1} height={d.height}\n\t\t\t\t\tfill={d.fill1} stroke={d.stroke1} fillOpacity={opacity} />\n\t\t\t\t<rect x={d.x + d.w1} y={d.y}\n\t\t\t\t\twidth={d.w2} height={d.height}\n\t\t\t\t\tfill={d.fill2} stroke={d.stroke2} fillOpacity={opacity} />\n\t\t\t</g>)}\n\t\t</g>;\n\t}\n}\n\nVolumeProfileSeries.propTypes = {\n\tclassName: PropTypes.string,\n\topacity: PropTypes.number,\n\tshowSessionBackground: PropTypes.bool,\n\tsessionBackGround: PropTypes.string,\n\tsessionBackGroundOpacity: PropTypes.number,\n};\n\n\nVolumeProfileSeries.defaultProps = {\n\tclassName: \"line \",\n\tbins: 20,\n\topacity: 0.5,\n\tmaxProfileWidthPercent: 50,\n\tfill: ({ type }) => type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n\tstroke: \"#FFFFFF\",\n\tshowSessionBackground: false,\n\tsessionBackGround: \"#4682B4\",\n\tsessionBackGroundOpacity: 0.3,\n\n\tsource: d => d.close,\n\tvolume: d => d.volume,\n\tabsoluteChange: d => d.absoluteChange,\n\tbySession: false,\n\t/* eslint-disable no-unused-vars */\n\tsessionStart: ({ d, i, plotData }) => i > 0 && plotData[i - 1].date.getMonth() !== d.date.getMonth(),\n\t/* eslint-enable no-unused-vars */\n\torient: \"left\",\n\t// // fill: ({ type }) => { var c = type === \"up\" ? \"#6BA583\" : \"#FF0000\"; console.log(type, c); return c },\n\t// stroke: ({ type }) =>  type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n\t// stroke: \"none\",\n\tpartialStartOK: true,\n\tpartialEndOK: true,\n};\n\nfunction helper(props, moreProps, xAccessor, width) {\n\tconst { xScale: realXScale, chartConfig: { yScale }, plotData } = moreProps;\n\n\tconst { sessionStart, bySession, partialStartOK, partialEndOK } = props;\n\tconst { bins, maxProfileWidthPercent, source, volume, absoluteChange, orient, fill, stroke } = props;\n\n\tconst sessionBuilder = accumulatingWindow()\n\t\t.discardTillStart(!partialStartOK)\n\t\t.discardTillEnd(!partialEndOK)\n\t\t.accumulateTill((d, i) => {\n\t\t\treturn sessionStart({ d, i, ...moreProps });\n\t\t})\n\t\t.accumulator(identity);\n\n\tconst dx = plotData.length > 1 ? realXScale(xAccessor(plotData[1])) - realXScale(xAccessor(head(plotData))) : 0;\n\n\tconst sessions = bySession ? sessionBuilder(plotData) : [plotData];\n\n\tconst allRects = sessions.map(session => {\n\n\t\tconst begin = bySession ? realXScale(xAccessor(head(session))) : 0;\n\t\tconst finish = bySession ? realXScale(xAccessor(last(session))) : width;\n\t\tconst sessionWidth = finish - begin + dx;\n\n\t\t// console.log(session)\n\n\t\t/* var histogram = d3.layout.histogram()\n\t\t\t\t.value(source)\n\t\t\t\t.bins(bins);*/\n\n\t\tconst histogram2 = d3Histogram()\n\t\t\t// .domain(xScale.domain())\n\t\t\t.value(source)\n\t\t\t.thresholds(bins);\n\n\t\t// console.log(bins, histogram(session))\n\t\t// console.log(bins, histogram2(session))\n\t\tconst rollup = nest()\n\t\t\t.key(d => d.direction)\n\t\t\t.sortKeys(orient === \"right\" ? descending : ascending)\n\t\t\t.rollup(leaves => sum(leaves, d => d.volume));\n\n\t\tconst values = histogram2(session);\n\t\t// console.log(\"values\", values)\n\n\t\tconst volumeInBins = values\n\t\t\t.map(arr => arr.map(d => absoluteChange(d) > 0 ? { direction: \"up\", volume: volume(d) } : { direction: \"down\", volume: volume(d) }))\n\t\t\t.map(arr => rollup.entries(arr));\n\n\t\t// console.log(\"volumeInBins\", volumeInBins)\n\t\tconst volumeValues = volumeInBins\n\t\t\t.map(each => sum(each.map(d => d.value)));\n\n\t\t// console.log(\"volumeValues\", volumeValues)\n\t\tconst base = xScale => head(xScale.range());\n\n\t\tconst [start, end] = orient === \"right\"\n\t\t\t? [begin, begin + sessionWidth * maxProfileWidthPercent / 100]\n\t\t\t: [finish, finish - sessionWidth * (100 - maxProfileWidthPercent) / 100];\n\n\t\tconst xScale = scaleLinear()\n\t\t\t.domain([0, max(volumeValues)])\n\t\t\t.range([start, end]);\n\n\t\t// console.log(xScale.domain())\n\n\t\tconst totalVolumes = volumeInBins.map(volumes => {\n\n\t\t\tconst totalVolume = sum(volumes, d => d.value);\n\t\t\tconst totalVolumeX = xScale(totalVolume);\n\t\t\tconst width = base(xScale) - totalVolumeX;\n\t\t\tconst x = width < 0 ? totalVolumeX + width : totalVolumeX;\n\n\t\t\tconst ws = volumes.map(d => {\n\t\t\t\treturn {\n\t\t\t\t\ttype: d.key,\n\t\t\t\t\twidth: d.value * Math.abs(width) / totalVolume,\n\t\t\t\t};\n\t\t\t});\n\n\t\t\treturn { x, ws, totalVolumeX };\n\t\t});\n\t\t// console.log(\"totalVolumes\", totalVolumes)\n\n\t\tconst rects = zip(values, totalVolumes)\n\t\t\t.map(([d, { x, ws }]) => {\n\t\t\t\tconst w1 = ws[0] || { type: \"up\", width: 0 };\n\t\t\t\tconst w2 = ws[1] || { type: \"down\", width: 0 };\n\n\t\t\t\treturn {\n\t\t\t\t\t// y: yScale(d.x + d.dx),\n\t\t\t\t\ty: yScale(d.x1),\n\t\t\t\t\t// height: yScale(d.x - d.dx) - yScale(d.x),\n\t\t\t\t\theight: yScale(d.x1) - yScale(d.x0),\n\t\t\t\t\tx,\n\t\t\t\t\twidth,\n\t\t\t\t\tw1: w1.width,\n\t\t\t\t\tw2: w2.width,\n\t\t\t\t\tstroke1: functor(stroke)(w1),\n\t\t\t\t\tstroke2: functor(stroke)(w2),\n\t\t\t\t\tfill1: functor(fill)(w1),\n\t\t\t\t\tfill2: functor(fill)(w2),\n\t\t\t\t};\n\t\t\t});\n\n\t\t// console.log(\"rects\", rects)\n\n\t\tconst sessionBg = {\n\t\t\tx: begin,\n\t\t\ty: last(rects).y,\n\t\t\theight: head(rects).y - last(rects).y + head(rects).height,\n\t\t\twidth: sessionWidth,\n\t\t};\n\n\t\treturn { rects, sessionBg };\n\t});\n\n\treturn {\n\t\trects: merge(allRects.map(d => d.rects)),\n\t\tsessionBg: allRects.map(d => d.sessionBg),\n\t};\n}\n\n\nfunction drawOnCanvas(ctx, props, rects, sessionBg) {\n\tconst { opacity, sessionBackGround, sessionBackGroundOpacity, showSessionBackground } = props;\n\n\t// var { rects, sessionBg } = helper(props, xScale, yScale, plotData);\n\n\tif (showSessionBackground) {\n\t\tctx.fillStyle = hexToRGBA(sessionBackGround, sessionBackGroundOpacity);\n\n\t\tsessionBg.forEach(each => {\n\t\t\tconst { x, y, height, width } = each;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, width, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t});\n\t}\n\n\trects.forEach(each => {\n\t\tconst { x, y, height, w1, w2, stroke1, stroke2, fill1, fill2 } = each;\n\n\n\t\tif (w1 > 0) {\n\t\t\tctx.fillStyle = hexToRGBA(fill1, opacity);\n\t\t\tif (stroke1 !== \"none\") ctx.strokeStyle = stroke1;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, w1, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\n\t\t\tif (stroke1 !== \"none\") ctx.stroke();\n\t\t}\n\n\t\tif (w2 > 0) {\n\t\t\tctx.fillStyle = hexToRGBA(fill2, opacity);\n\t\t\tif (stroke2 !== \"none\") ctx.strokeStyle = stroke2;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x + w1, y, w2, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\n\t\t\tif (stroke2 !== \"none\") ctx.stroke();\n\t\t}\n\n\t});\n}\n\nexport default VolumeProfileSeries;\n"]},"metadata":{},"sourceType":"script"}
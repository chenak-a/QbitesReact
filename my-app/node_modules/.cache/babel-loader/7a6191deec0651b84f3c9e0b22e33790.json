{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _utils = require(\"../utils\");\n\nvar _utils2 = require(\"./utils\");\n\nvar _GenericComponent = require(\"../GenericComponent\");\n\nvar _GenericComponent2 = _interopRequireDefault(_GenericComponent);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar DrawingObjectSelector = function (_Component) {\n  _inherits(DrawingObjectSelector, _Component);\n\n  function DrawingObjectSelector(props) {\n    _classCallCheck(this, DrawingObjectSelector);\n\n    var _this = _possibleConstructorReturn(this, (DrawingObjectSelector.__proto__ || Object.getPrototypeOf(DrawingObjectSelector)).call(this, props));\n\n    _this.handleClick = _this.handleClick.bind(_this);\n    _this.handleDoubleClick = _this.handleDoubleClick.bind(_this);\n    _this.getInteraction = _this.getInteraction.bind(_this);\n    return _this;\n  }\n\n  _createClass(DrawingObjectSelector, [{\n    key: \"handleDoubleClick\",\n    value: function handleDoubleClick(moreProps, e) {\n      e.preventDefault();\n      var onDoubleClick = this.props.onDoubleClick;\n      var enabled = this.props.enabled;\n      if (!enabled) return;\n      var interactives = this.getInteraction(moreProps);\n      var allSelected = (0, _utils2.getSelected)(interactives); // console.log(selected, interactives)\n\n      if (allSelected.length > 0) {\n        var selected = (0, _utils.head)(allSelected);\n        var item = {\n          type: selected.type,\n          chartId: selected.chartId,\n          object: (0, _utils.head)(selected.objects)\n        };\n        var morePropsForChart = (0, _utils2.getMorePropsForChart)(moreProps, selected.chartId);\n        onDoubleClick(item, morePropsForChart);\n      }\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick(moreProps, e) {\n      e.preventDefault();\n      var onSelect = this.props.onSelect;\n      var enabled = this.props.enabled;\n      if (!enabled) return;\n      var interactives = this.getInteraction(moreProps);\n      onSelect(interactives, moreProps);\n    }\n  }, {\n    key: \"getInteraction\",\n    value: function getInteraction(moreProps) {\n      var _props = this.props,\n          getInteractiveNodes = _props.getInteractiveNodes,\n          drawingObjectMap = _props.drawingObjectMap;\n      var interactiveNodes = getInteractiveNodes();\n      var interactives = (0, _utils.mapObject)(interactiveNodes, function (each) {\n        var key = drawingObjectMap[each.type];\n        var valueArray = (0, _utils.isDefined)(key) ? each.node.props[key] : undefined;\n        var valuePresent = (0, _utils.isDefined)(valueArray) && Array.isArray(valueArray) && valueArray.length > 0;\n\n        if (valuePresent) {\n          // console.log(\"Value present for \", each.type, each.chartId);\n          var morePropsForChart = (0, _utils2.getMorePropsForChart)(moreProps, each.chartId);\n          var objects = each.node.getSelectionState(morePropsForChart);\n          return {\n            type: each.type,\n            chartId: each.chartId,\n            objects: objects\n          };\n        }\n\n        return {\n          type: each.type,\n          chartId: each.chartId,\n          objects: []\n        };\n      });\n      return interactives;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(_GenericComponent2.default, {\n        svgDraw: _utils.noop,\n        canvasToDraw: _GenericComponent.getMouseCanvas,\n        canvasDraw: _utils.noop,\n        onMouseDown: this.handleClick,\n        onDoubleClick: this.handleDoubleClick,\n        drawOn: [\"mousemove\", \"pan\", \"drag\"]\n      });\n    }\n  }]);\n\n  return DrawingObjectSelector;\n}(_react.Component);\n\nDrawingObjectSelector.propTypes = {\n  getInteractiveNodes: _propTypes2.default.func.isRequired,\n  onSelect: _propTypes2.default.func.isRequired,\n  onDoubleClick: _propTypes2.default.func.isRequired,\n  drawingObjectMap: _propTypes2.default.object.isRequired,\n  enabled: _propTypes2.default.bool.isRequired\n};\nDrawingObjectSelector.defaultProps = {\n  enabled: true,\n  onDoubleClick: _utils.noop\n};\nexports.default = DrawingObjectSelector;","map":{"version":3,"sources":["../../../src/lib/interactive/DrawingObjectSelector.js"],"names":["DrawingObjectSelector","moreProps","e","onDoubleClick","enabled","interactives","allSelected","selected","item","type","chartId","object","morePropsForChart","onSelect","getInteractiveNodes","drawingObjectMap","interactiveNodes","key","each","valueArray","valuePresent","Array","objects","isRequired"],"mappings":"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","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, noop, mapObject, head } from \"../utils\";\nimport { getMorePropsForChart, getSelected } from \"./utils\";\n\nimport GenericComponent, { getMouseCanvas } from \"../GenericComponent\";\n\nclass DrawingObjectSelector extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.handleDoubleClick = this.handleDoubleClick.bind(this);\n\t\tthis.getInteraction = this.getInteraction.bind(this);\n\t}\n\thandleDoubleClick(moreProps, e) {\n\t\te.preventDefault();\n\t\tconst { onDoubleClick } = this.props;\n\t\tconst { enabled } = this.props;\n\t\tif (!enabled) return;\n\n\t\tconst interactives = this.getInteraction(moreProps);\n\t\tconst allSelected = getSelected(interactives);\n\n\t\t// console.log(selected, interactives)\n\t\tif (allSelected.length > 0) {\n\t\t\tconst selected = head(allSelected);\n\t\t\tconst item = {\n\t\t\t\ttype: selected.type,\n\t\t\t\tchartId: selected.chartId,\n\t\t\t\tobject: head(selected.objects)\n\t\t\t};\n\t\t\tconst morePropsForChart = getMorePropsForChart(\n\t\t\t\tmoreProps, selected.chartId\n\t\t\t);\n\t\t\tonDoubleClick(item, morePropsForChart);\n\t\t}\n\t}\n\thandleClick(moreProps, e) {\n\t\te.preventDefault();\n\t\tconst { onSelect } = this.props;\n\t\tconst { enabled } = this.props;\n\t\tif (!enabled) return;\n\n\t\tconst interactives = this.getInteraction(moreProps);\n\n\t\tonSelect(interactives, moreProps);\n\t}\n\tgetInteraction(moreProps) {\n\t\tconst { getInteractiveNodes, drawingObjectMap } = this.props;\n\t\tconst interactiveNodes = getInteractiveNodes();\n\t\tconst interactives = mapObject(interactiveNodes, each => {\n\t\t\tconst key = drawingObjectMap[each.type];\n\n\t\t\tconst valueArray = isDefined(key)\n\t\t\t\t? each.node.props[key]\n\t\t\t\t: undefined;\n\n\t\t\tconst valuePresent = isDefined(valueArray)\n\t\t\t\t&& Array.isArray(valueArray)\n\t\t\t\t&& valueArray.length > 0;\n\t\t\tif (valuePresent) {\n\t\t\t\t// console.log(\"Value present for \", each.type, each.chartId);\n\t\t\t\tconst morePropsForChart = getMorePropsForChart(\n\t\t\t\t\tmoreProps, each.chartId\n\t\t\t\t);\n\n\t\t\t\tconst objects = each.node.getSelectionState(morePropsForChart);\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: each.type,\n\t\t\t\t\tchartId: each.chartId,\n\t\t\t\t\tobjects,\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\ttype: each.type,\n\t\t\t\tchartId: each.chartId,\n\t\t\t\tobjects: [],\n\t\t\t};\n\t\t});\n\n\t\treturn interactives;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<GenericComponent\n\t\t\t\tsvgDraw={noop}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tcanvasDraw={noop}\n\n\t\t\t\tonMouseDown={this.handleClick}\n\t\t\t\tonDoubleClick={this.handleDoubleClick}\n\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\n\t\t\t/>\n\t\t);\n\t}\n}\n\n\nDrawingObjectSelector.propTypes = {\n\tgetInteractiveNodes: PropTypes.func.isRequired,\n\tonSelect: PropTypes.func.isRequired,\n\tonDoubleClick: PropTypes.func.isRequired,\n\tdrawingObjectMap: PropTypes.object.isRequired,\n\tenabled: PropTypes.bool.isRequired,\n};\n\nDrawingObjectSelector.defaultProps = {\n\tenabled: true,\n\tonDoubleClick: noop,\n};\n\nexport default DrawingObjectSelector;\n"]},"metadata":{},"sourceType":"script"}
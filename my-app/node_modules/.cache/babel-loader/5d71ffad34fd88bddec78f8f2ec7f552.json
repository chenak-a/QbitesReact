{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _saveSvgAsPng = require(\"save-svg-as-png\");\n\nvar _saveSvgAsPng2 = _interopRequireDefault(_saveSvgAsPng);\n\nvar _utils = require(\"../utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar dx = 0;\nvar dy = 0;\nvar SaveChartAsImage = {\n  save: function save(doc, container, background, cb) {\n    _saveSvgAsPng2.default.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function (uri) {\n      // eslint-disable-next-line prefer-const\n      var image = new Image();\n\n      image.onload = function () {\n        // eslint-disable-next-line prefer-const\n        var canvas = doc.createElement(\"canvas\");\n        canvas.width = image.width;\n        canvas.height = image.height; // eslint-disable-next-line prefer-const\n\n        var context = canvas.getContext(\"2d\");\n\n        if ((0, _utils.isDefined)(background)) {\n          context.fillStyle = background;\n          context.fillRect(0, 0, canvas.width, canvas.height);\n        }\n\n        var canvasList = container.getElementsByTagName(\"canvas\");\n\n        for (var i = 0; i < canvasList.length; i++) {\n          var each = canvasList[i];\n\n          if ((0, _utils.isDefined)(each)) {\n            var parent = each.parentNode.parentNode.getBoundingClientRect();\n            var rect = each.getBoundingClientRect();\n            context.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\n          }\n        }\n\n        context.drawImage(image, dx, dy);\n        cb(canvas.toDataURL(\"image/png\"));\n      };\n\n      image.src = uri;\n    });\n  },\n  saveWithWhiteBG: function saveWithWhiteBG(doc, container, cb) {\n    return this.saveWithBG(doc, container, \"white\", cb);\n  },\n  saveWithDarkBG: function saveWithDarkBG(doc, container, cb) {\n    return this.saveWithBG(doc, container, \"#303030\", cb);\n  },\n  saveWithBG: function saveWithBG(doc, container, background, cb) {\n    return this.save(doc, container, background, cb);\n  },\n  saveChartAsImage: function saveChartAsImage(container) {\n    this.saveWithWhiteBG(document, container, function (src) {\n      var a = document.createElement(\"a\");\n      a.setAttribute(\"href\", src);\n      a.setAttribute(\"download\", \"Chart.png\");\n      document.body.appendChild(a);\n      a.addEventListener(\"click\", function ()\n      /* e */\n      {\n        a.parentNode.removeChild(a);\n      });\n      a.click();\n    });\n  }\n};\nexports.default = SaveChartAsImage;","map":{"version":3,"mappings":"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","names":["dx","dy","SaveChartAsImage","save","doc","container","background","cb","_saveSvgAsPng2","svgAsDataUri","getElementsByTagName","uri","image","Image","onload","canvas","createElement","width","height","context","getContext","fillStyle","fillRect","canvasList","i","length","each","parent","parentNode","getBoundingClientRect","rect","drawImage","left","top","toDataURL","src","saveWithWhiteBG","saveWithBG","saveWithDarkBG","saveChartAsImage","document","a","setAttribute","body","appendChild","addEventListener","removeChild","click"],"sources":["../../../src/lib/helper/SaveChartAsImage.js"],"sourcesContent":["\n\nimport saveAsPng from \"save-svg-as-png\";\nimport { isDefined } from \"../utils\";\n\nconst dx = 0;\nconst dy = 0;\n\nconst SaveChartAsImage = {\n\tsave(doc, container, background, cb) {\n\t\tsaveAsPng.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function(uri) {\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tlet image = new Image();\n\t\t\timage.onload = function() {\n\n\t\t\t\t// eslint-disable-next-line prefer-const\n\t\t\t\tlet canvas = doc.createElement(\"canvas\");\n\t\t\t\tcanvas.width = image.width;\n\t\t\t\tcanvas.height = image.height;\n\n\t\t\t\t// eslint-disable-next-line prefer-const\n\t\t\t\tlet context = canvas.getContext(\"2d\");\n\n\t\t\t\tif (isDefined(background)) {\n\t\t\t\t\tcontext.fillStyle = background;\n\t\t\t\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t}\n\t\t\t\tconst canvasList = container.getElementsByTagName(\"canvas\");\n\t\t\t\tfor (let i = 0; i < canvasList.length; i++) {\n\t\t\t\t\tconst each = canvasList[i];\n\t\t\t\t\tif (isDefined(each)) {\n\t\t\t\t\t\tconst parent = each.parentNode.parentNode.getBoundingClientRect();\n\t\t\t\t\t\tconst rect = each.getBoundingClientRect();\n\t\t\t\t\t\tcontext.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcontext.drawImage(image, dx, dy);\n\t\t\t\tcb(canvas.toDataURL(\"image/png\"));\n\t\t\t};\n\t\t\timage.src = uri;\n\t\t});\n\t},\n\tsaveWithWhiteBG(doc, container, cb) {\n\t\treturn this.saveWithBG(doc, container, \"white\", cb);\n\t},\n\tsaveWithDarkBG(doc, container, cb) {\n\t\treturn this.saveWithBG(doc, container, \"#303030\", cb);\n\t},\n\tsaveWithBG(doc, container, background, cb) {\n\t\treturn this.save(doc, container, background, cb);\n\t},\n\tsaveChartAsImage(container) {\n\t\tthis.saveWithWhiteBG(document, container, function(src) {\n\t\t\tconst a = document.createElement(\"a\");\n\t\t\ta.setAttribute(\"href\", src);\n\t\t\ta.setAttribute(\"download\", \"Chart.png\");\n\n\t\t\tdocument.body.appendChild(a);\n\t\t\ta.addEventListener(\"click\", function(/* e */) {\n\t\t\t\ta.parentNode.removeChild(a);\n\t\t\t});\n\n\t\t\ta.click();\n\t\t});\n\t}\n};\n\nexport default SaveChartAsImage;"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _utils = require(\"../utils\");\n\nvar _utils2 = require(\"./utils\");\n\nvar _EachFibRetracement = require(\"./wrapper/EachFibRetracement\");\n\nvar _EachFibRetracement2 = _interopRequireDefault(_EachFibRetracement);\n\nvar _MouseLocationIndicator = require(\"./components/MouseLocationIndicator\");\n\nvar _MouseLocationIndicator2 = _interopRequireDefault(_MouseLocationIndicator);\n\nvar _HoverTextNearMouse = require(\"./components/HoverTextNearMouse\");\n\nvar _HoverTextNearMouse2 = _interopRequireDefault(_HoverTextNearMouse);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar FibonacciRetracement = function (_Component) {\n  _inherits(FibonacciRetracement, _Component);\n\n  function FibonacciRetracement(props) {\n    _classCallCheck(this, FibonacciRetracement);\n\n    var _this = _possibleConstructorReturn(this, (FibonacciRetracement.__proto__ || Object.getPrototypeOf(FibonacciRetracement)).call(this, props));\n\n    _this.handleStart = _this.handleStart.bind(_this);\n    _this.handleEnd = _this.handleEnd.bind(_this);\n    _this.handleDrawRetracement = _this.handleDrawRetracement.bind(_this);\n    _this.handleEdge1Drag = _this.handleEdge1Drag.bind(_this);\n    _this.handleEdge2Drag = _this.handleEdge2Drag.bind(_this);\n    _this.handleDrag = _this.handleDrag.bind(_this);\n    _this.handleDragComplete = _this.handleDragComplete.bind(_this);\n    _this.terminate = _utils2.terminate.bind(_this);\n    _this.getSelectionState = (0, _utils2.isHoverForInteractiveType)(\"retracements\").bind(_this);\n    _this.saveNodeType = _utils2.saveNodeType.bind(_this);\n    _this.nodes = [];\n    _this.state = {};\n    return _this;\n  }\n\n  _createClass(FibonacciRetracement, [{\n    key: \"handleDrawRetracement\",\n    value: function handleDrawRetracement(xyValue) {\n      var current = this.state.current;\n\n      if ((0, _utils.isDefined)(current) && (0, _utils.isDefined)(current.x1)) {\n        this.mouseMoved = true;\n        this.setState({\n          current: _extends({}, current, {\n            x2: xyValue[0],\n            y2: xyValue[1]\n          })\n        });\n      }\n    }\n  }, {\n    key: \"handleDrag\",\n    value: function handleDrag(index, xy) {\n      this.setState({\n        override: _extends({\n          index: index\n        }, xy)\n      });\n    }\n  }, {\n    key: \"handleEdge1Drag\",\n    value: function handleEdge1Drag(echo, newXYValue, origXYValue) {\n      var retracements = this.props.retracements;\n      var index = echo.index;\n      var dx = origXYValue.x1Value - newXYValue.x1Value;\n      this.setState({\n        override: {\n          index: index,\n          x1: retracements[index].x1 - dx,\n          y1: retracements[index].y1,\n          x2: retracements[index].x2,\n          y2: retracements[index].y2\n        }\n      });\n    }\n  }, {\n    key: \"handleEdge2Drag\",\n    value: function handleEdge2Drag(echo, newXYValue, origXYValue) {\n      var retracements = this.props.retracements;\n      var index = echo.index;\n      var dx = origXYValue.x2Value - newXYValue.x2Value;\n      this.setState({\n        override: {\n          index: index,\n          x1: retracements[index].x1,\n          y1: retracements[index].y1,\n          x2: retracements[index].x2 - dx,\n          y2: retracements[index].y2\n        }\n      });\n    }\n  }, {\n    key: \"handleDragComplete\",\n    value: function handleDragComplete(moreProps) {\n      var _this2 = this;\n\n      var retracements = this.props.retracements;\n      var override = this.state.override;\n\n      if ((0, _utils.isDefined)(override)) {\n        var index = override.index,\n            rest = _objectWithoutProperties(override, [\"index\"]);\n\n        var newRetracements = retracements.map(function (each, idx) {\n          return idx === index ? _extends({}, each, rest, {\n            selected: true\n          }) : each;\n        });\n        this.setState({\n          override: null\n        }, function () {\n          _this2.props.onComplete(newRetracements, moreProps);\n        });\n      }\n    }\n  }, {\n    key: \"handleStart\",\n    value: function handleStart(xyValue, moreProps) {\n      var _this3 = this;\n\n      var current = this.state.current;\n\n      if ((0, _utils.isNotDefined)(current) || (0, _utils.isNotDefined)(current.x1)) {\n        this.mouseMoved = false;\n        this.setState({\n          current: {\n            x1: xyValue[0],\n            y1: xyValue[1],\n            x2: null,\n            y2: null\n          }\n        }, function () {\n          _this3.props.onStart(moreProps);\n        });\n      }\n    }\n  }, {\n    key: \"handleEnd\",\n    value: function handleEnd(xyValue, moreProps, e) {\n      var _this4 = this;\n\n      var _props = this.props,\n          retracements = _props.retracements,\n          appearance = _props.appearance,\n          type = _props.type;\n      var current = this.state.current;\n\n      if (this.mouseMoved && (0, _utils.isDefined)(current) && (0, _utils.isDefined)(current.x1)) {\n        var newRetracements = retracements.concat(_extends({}, current, {\n          x2: xyValue[0],\n          y2: xyValue[1],\n          selected: true,\n          appearance: appearance,\n          type: type\n        }));\n        this.setState({\n          current: null\n        }, function () {\n          _this4.props.onComplete(newRetracements, moreProps, e);\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var _state = this.state,\n          current = _state.current,\n          override = _state.override;\n      var retracements = this.props.retracements;\n      var _props2 = this.props,\n          appearance = _props2.appearance,\n          type = _props2.type;\n      var _props3 = this.props,\n          currentPositionStroke = _props3.currentPositionStroke,\n          currentPositionOpacity = _props3.currentPositionOpacity,\n          currentPositionStrokeWidth = _props3.currentPositionStrokeWidth,\n          currentPositionRadius = _props3.currentPositionRadius;\n      var _props4 = this.props,\n          enabled = _props4.enabled,\n          hoverText = _props4.hoverText;\n      var overrideIndex = (0, _utils.isDefined)(override) ? override.index : null;\n\n      var hoverTextWidthDefault = _extends({}, FibonacciRetracement.defaultProps.hoverText, hoverText);\n\n      var currentRetracement = (0, _utils.isDefined)(current) && (0, _utils.isDefined)(current.x2) ? _react2.default.createElement(_EachFibRetracement2.default, _extends({\n        interactive: false,\n        type: type,\n        appearance: appearance,\n        hoverText: hoverTextWidthDefault\n      }, current)) : null;\n      return _react2.default.createElement(\"g\", null, retracements.map(function (each, idx) {\n        var eachAppearance = (0, _utils.isDefined)(each.appearance) ? _extends({}, appearance, each.appearance) : appearance;\n        var eachHoverText = (0, _utils.isDefined)(each.hoverText) ? _extends({}, hoverTextWidthDefault, each.hoverText) : hoverTextWidthDefault;\n        return _react2.default.createElement(_EachFibRetracement2.default, _extends({\n          key: idx,\n          ref: _this5.saveNodeType(idx),\n          index: idx,\n          type: each.type,\n          selected: each.selected\n        }, idx === overrideIndex ? override : each, {\n          hoverText: eachHoverText,\n          appearance: eachAppearance,\n          onDrag: _this5.handleDrag,\n          onDragComplete: _this5.handleDragComplete\n        }));\n      }), currentRetracement, _react2.default.createElement(_MouseLocationIndicator2.default, {\n        enabled: enabled,\n        snap: false,\n        r: currentPositionRadius,\n        stroke: currentPositionStroke,\n        opacity: currentPositionOpacity,\n        strokeWidth: currentPositionStrokeWidth,\n        onMouseDown: this.handleStart,\n        onClick: this.handleEnd,\n        onMouseMove: this.handleDrawRetracement\n      }));\n    }\n  }]);\n\n  return FibonacciRetracement;\n}(_react.Component); // onClick={this.handleClick}\n\n\nFibonacciRetracement.propTypes = {\n  enabled: _propTypes2.default.bool.isRequired,\n  width: _propTypes2.default.number,\n  onStart: _propTypes2.default.func,\n  onComplete: _propTypes2.default.func,\n  onSelect: _propTypes2.default.func,\n  type: _propTypes2.default.oneOf([\"EXTEND\", // extends from -Infinity to +Infinity\n  \"RAY\", // extends to +/-Infinity in one direction\n  \"BOUND\" // extends between the set bounds\n  ]).isRequired,\n  hoverText: _propTypes2.default.object.isRequired,\n  currentPositionStroke: _propTypes2.default.string,\n  currentPositionStrokeWidth: _propTypes2.default.number,\n  currentPositionOpacity: _propTypes2.default.number,\n  currentPositionRadius: _propTypes2.default.number,\n  retracements: _propTypes2.default.array.isRequired,\n  appearance: _propTypes2.default.shape({\n    stroke: _propTypes2.default.string.isRequired,\n    strokeWidth: _propTypes2.default.number.isRequired,\n    strokeOpacity: _propTypes2.default.number.isRequired,\n    fontFamily: _propTypes2.default.string.isRequired,\n    fontSize: _propTypes2.default.number.isRequired,\n    fontFill: _propTypes2.default.string.isRequired,\n    edgeStroke: _propTypes2.default.string.isRequired,\n    edgeFill: _propTypes2.default.string.isRequired,\n    nsEdgeFill: _propTypes2.default.string.isRequired,\n    edgeStrokeWidth: _propTypes2.default.number.isRequired,\n    r: _propTypes2.default.number.isRequired\n  }).isRequired\n};\nFibonacciRetracement.defaultProps = {\n  enabled: true,\n  type: \"RAY\",\n  retracements: [],\n  onStart: _utils.noop,\n  onComplete: _utils.noop,\n  onSelect: _utils.noop,\n  hoverText: _extends({}, _HoverTextNearMouse2.default.defaultProps, {\n    enable: true,\n    bgHeight: \"auto\",\n    bgWidth: \"auto\",\n    text: \"Click to select object\",\n    selectedText: \"\"\n  }),\n  currentPositionStroke: \"#000000\",\n  currentPositionOpacity: 1,\n  currentPositionStrokeWidth: 3,\n  currentPositionRadius: 4,\n  appearance: {\n    stroke: \"#000000\",\n    strokeWidth: 1,\n    strokeOpacity: 1,\n    fontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n    fontSize: 11,\n    fontFill: \"#000000\",\n    edgeStroke: \"#000000\",\n    edgeFill: \"#FFFFFF\",\n    nsEdgeFill: \"#000000\",\n    edgeStrokeWidth: 1,\n    r: 5\n  }\n};\nexports.default = FibonacciRetracement;","map":{"version":3,"mappings":"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","names":["FibonacciRetracement","props","_classCallCheck","_this","handleStart","bind","handleEnd","handleDrawRetracement","handleEdge1Drag","handleEdge2Drag","handleDrag","handleDragComplete","terminate","_utils2","getSelectionState","saveNodeType","nodes","state","xyValue","current","x1","mouseMoved","setState","x2","y2","index","xy","override","echo","newXYValue","origXYValue","retracements","dx","x1Value","y1","x2Value","moreProps","rest","newRetracements","map","each","idx","selected","_this2","onComplete","_this3","onStart","e","appearance","type","concat","_this4","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","currentPositionRadius","enabled","hoverText","overrideIndex","hoverTextWidthDefault","defaultProps","currentRetracement","_react2","interactive","eachAppearance","eachHoverText","key","ref","_this5","onDrag","onDragComplete","snap","r","stroke","opacity","strokeWidth","onMouseDown","onClick","onMouseMove","propTypes","_propTypes2","bool","isRequired","width","number","func","onSelect","oneOf","object","string","array","shape","strokeOpacity","fontFamily","fontSize","fontFill","edgeStroke","edgeFill","nsEdgeFill","edgeStrokeWidth","_HoverTextNearMouse2","enable","bgHeight","bgWidth","text","selectedText"],"sources":["../../../src/lib/interactive/FibonacciRetracement.js"],"sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, isNotDefined, noop } from \"../utils\";\nimport {\n\tterminate,\n\tsaveNodeType,\n\tisHoverForInteractiveType,\n} from \"./utils\";\nimport EachFibRetracement from \"./wrapper/EachFibRetracement\";\nimport MouseLocationIndicator from \"./components/MouseLocationIndicator\";\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\n\nclass FibonacciRetracement extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleStart = this.handleStart.bind(this);\n\t\tthis.handleEnd = this.handleEnd.bind(this);\n\t\tthis.handleDrawRetracement = this.handleDrawRetracement.bind(this);\n\n\t\tthis.handleEdge1Drag = this.handleEdge1Drag.bind(this);\n\t\tthis.handleEdge2Drag = this.handleEdge2Drag.bind(this);\n\n\t\tthis.handleDrag = this.handleDrag.bind(this);\n\t\tthis.handleDragComplete = this.handleDragComplete.bind(this);\n\n\t\tthis.terminate = terminate.bind(this);\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"retracements\")\n\t\t\t.bind(this);\n\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\t\tthis.nodes = [];\n\n\t\tthis.state = {\n\t\t};\n\t}\n\thandleDrawRetracement(xyValue) {\n\t\tconst { current } = this.state;\n\t\tif (isDefined(current) && isDefined(current.x1)) {\n\t\t\tthis.mouseMoved = true;\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\t...current,\n\t\t\t\t\tx2: xyValue[0],\n\t\t\t\t\ty2: xyValue[1]\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\thandleDrag(index, xy) {\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\t...xy\n\t\t\t}\n\t\t});\n\t}\n\thandleEdge1Drag(echo, newXYValue, origXYValue) {\n\t\tconst { retracements } = this.props;\n\t\tconst { index } = echo;\n\n\t\tconst dx = origXYValue.x1Value - newXYValue.x1Value;\n\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\tx1: retracements[index].x1 - dx,\n\t\t\t\ty1: retracements[index].y1,\n\t\t\t\tx2: retracements[index].x2,\n\t\t\t\ty2: retracements[index].y2\n\t\t\t}\n\t\t});\n\t}\n\thandleEdge2Drag(echo, newXYValue, origXYValue) {\n\t\tconst { retracements } = this.props;\n\t\tconst { index } = echo;\n\n\t\tconst dx = origXYValue.x2Value - newXYValue.x2Value;\n\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\tx1: retracements[index].x1,\n\t\t\t\ty1: retracements[index].y1,\n\t\t\t\tx2: retracements[index].x2 - dx,\n\t\t\t\ty2: retracements[index].y2\n\t\t\t}\n\t\t});\n\t}\n\thandleDragComplete(moreProps) {\n\t\tconst { retracements } = this.props;\n\t\tconst { override } = this.state;\n\t\tif (isDefined(override)) {\n\t\t\tconst { index, ...rest } = override;\n\n\t\t\tconst newRetracements = retracements.map(\n\t\t\t\t(each, idx) =>\n\t\t\t\t\t(idx === index\n\t\t\t\t\t\t? { ...each, ...rest, selected: true }\n\t\t\t\t\t\t: each)\n\t\t\t);\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\toverride: null,\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tthis.props.onComplete(newRetracements, moreProps);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\thandleStart(xyValue, moreProps) {\n\t\tconst { current } = this.state;\n\t\tif (isNotDefined(current) || isNotDefined(current.x1)) {\n\t\t\tthis.mouseMoved = false;\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tcurrent: {\n\t\t\t\t\t\tx1: xyValue[0],\n\t\t\t\t\t\ty1: xyValue[1],\n\t\t\t\t\t\tx2: null,\n\t\t\t\t\t\ty2: null\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tthis.props.onStart(moreProps);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\thandleEnd(xyValue, moreProps, e) {\n\t\tconst { retracements, appearance, type } = this.props;\n\t\tconst { current } = this.state;\n\n\t\tif (this.mouseMoved && isDefined(current) && isDefined(current.x1)) {\n\t\t\tconst newRetracements = retracements.concat({\n\t\t\t\t...current,\n\t\t\t\tx2: xyValue[0],\n\t\t\t\ty2: xyValue[1],\n\t\t\t\tselected: true,\n\t\t\t\tappearance,\n\t\t\t\ttype,\n\t\t\t});\n\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tcurrent: null,\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tthis.props.onComplete(newRetracements, moreProps, e);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\trender() {\n\t\tconst { current, override } = this.state;\n\t\tconst { retracements } = this.props;\n\n\t\tconst {\n\t\t\tappearance,\n\t\t\ttype\n\t\t} = this.props;\n\t\tconst {\n\t\t\tcurrentPositionStroke,\n\t\t\tcurrentPositionOpacity,\n\t\t\tcurrentPositionStrokeWidth,\n\t\t\tcurrentPositionRadius\n\t\t} = this.props;\n\n\t\tconst { enabled, hoverText } = this.props;\n\t\tconst overrideIndex = isDefined(override) ? override.index : null;\n\t\tconst hoverTextWidthDefault = {\n\t\t\t...FibonacciRetracement.defaultProps.hoverText,\n\t\t\t...hoverText\n\t\t};\n\n\t\tconst currentRetracement = isDefined(current) && isDefined(current.x2)\n\t\t\t? <EachFibRetracement\n\t\t\t\tinteractive={false}\n\t\t\t\ttype={type}\n\t\t\t\tappearance={appearance}\n\t\t\t\thoverText={hoverTextWidthDefault}\n\t\t\t\t{...current}\n\t\t\t/>\n\t\t\t: null;\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t{retracements.map((each, idx) => {\n\t\t\t\t\tconst eachAppearance = isDefined(each.appearance)\n\t\t\t\t\t\t? { ...appearance, ...each.appearance }\n\t\t\t\t\t\t: appearance;\n\n\t\t\t\t\tconst eachHoverText = isDefined(each.hoverText)\n\t\t\t\t\t\t? { ...hoverTextWidthDefault, ...each.hoverText }\n\t\t\t\t\t\t: hoverTextWidthDefault;\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<EachFibRetracement\n\t\t\t\t\t\t\tkey={idx}\n\t\t\t\t\t\t\tref={this.saveNodeType(idx)}\n\t\t\t\t\t\t\tindex={idx}\n\t\t\t\t\t\t\ttype={each.type}\n\t\t\t\t\t\t\tselected={each.selected}\n\t\t\t\t\t\t\t{...(idx === overrideIndex ? override : each)}\n\t\t\t\t\t\t\thoverText={eachHoverText}\n\t\t\t\t\t\t\tappearance={eachAppearance}\n\t\t\t\t\t\t\tonDrag={this.handleDrag}\n\t\t\t\t\t\t\tonDragComplete={this.handleDragComplete}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t\t{currentRetracement}\n\t\t\t\t<MouseLocationIndicator\n\t\t\t\t\tenabled={enabled}\n\t\t\t\t\tsnap={false}\n\t\t\t\t\tr={currentPositionRadius}\n\t\t\t\t\tstroke={currentPositionStroke}\n\t\t\t\t\topacity={currentPositionOpacity}\n\t\t\t\t\tstrokeWidth={currentPositionStrokeWidth}\n\t\t\t\t\tonMouseDown={this.handleStart}\n\t\t\t\t\tonClick={this.handleEnd}\n\t\t\t\t\tonMouseMove={this.handleDrawRetracement}\n\t\t\t\t/>\n\t\t\t</g>\n\t\t);\n\t}\n}\n\n// onClick={this.handleClick}\n\nFibonacciRetracement.propTypes = {\n\tenabled: PropTypes.bool.isRequired,\n\twidth: PropTypes.number,\n\n\tonStart: PropTypes.func,\n\tonComplete: PropTypes.func,\n\tonSelect: PropTypes.func,\n\n\ttype: PropTypes.oneOf([\n\t\t\"EXTEND\", // extends from -Infinity to +Infinity\n\t\t\"RAY\", // extends to +/-Infinity in one direction\n\t\t\"BOUND\" // extends between the set bounds\n\t]).isRequired,\n\thoverText: PropTypes.object.isRequired,\n\n\tcurrentPositionStroke: PropTypes.string,\n\tcurrentPositionStrokeWidth: PropTypes.number,\n\tcurrentPositionOpacity: PropTypes.number,\n\tcurrentPositionRadius: PropTypes.number,\n\n\tretracements: PropTypes.array.isRequired,\n\n\tappearance: PropTypes.shape({\n\t\tstroke: PropTypes.string.isRequired,\n\t\tstrokeWidth: PropTypes.number.isRequired,\n\t\tstrokeOpacity: PropTypes.number.isRequired,\n\t\tfontFamily: PropTypes.string.isRequired,\n\t\tfontSize: PropTypes.number.isRequired,\n\t\tfontFill: PropTypes.string.isRequired,\n\t\tedgeStroke: PropTypes.string.isRequired,\n\t\tedgeFill: PropTypes.string.isRequired,\n\t\tnsEdgeFill: PropTypes.string.isRequired,\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\n\t\tr: PropTypes.number.isRequired,\n\t}).isRequired\n};\n\nFibonacciRetracement.defaultProps = {\n\tenabled: true,\n\ttype: \"RAY\",\n\tretracements: [],\n\n\tonStart: noop,\n\tonComplete: noop,\n\tonSelect: noop,\n\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: \"auto\",\n\t\tbgWidth: \"auto\",\n\t\ttext: \"Click to select object\",\n\t\tselectedText: \"\",\n\t},\n\tcurrentPositionStroke: \"#000000\",\n\tcurrentPositionOpacity: 1,\n\tcurrentPositionStrokeWidth: 3,\n\tcurrentPositionRadius: 4,\n\n\tappearance: {\n\t\tstroke: \"#000000\",\n\t\tstrokeWidth: 1,\n\t\tstrokeOpacity: 1,\n\t\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n\t\tfontSize: 11,\n\t\tfontFill: \"#000000\",\n\t\tedgeStroke: \"#000000\",\n\t\tedgeFill: \"#FFFFFF\",\n\t\tnsEdgeFill: \"#000000\",\n\t\tedgeStrokeWidth: 1,\n\t\tr: 5,\n\t}\n};\n\nexport default FibonacciRetracement;\n"]},"metadata":{},"sourceType":"script"}
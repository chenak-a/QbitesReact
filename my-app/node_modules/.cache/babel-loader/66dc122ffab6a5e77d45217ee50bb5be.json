{"ast":null,"code":"import map from \"./map\";\nexport default function () {\n  var keys = [],\n      sortKeys = [],\n      sortValues,\n      rollup,\n      nest;\n\n  function apply(array, depth, createResult, setResult) {\n    if (depth >= keys.length) {\n      if (sortValues != null) array.sort(sortValues);\n      return rollup != null ? rollup(array) : array;\n    }\n\n    var i = -1,\n        n = array.length,\n        key = keys[depth++],\n        keyValue,\n        value,\n        valuesByKey = map(),\n        values,\n        result = createResult();\n\n    while (++i < n) {\n      if (values = valuesByKey.get(keyValue = key(value = array[i]) + \"\")) {\n        values.push(value);\n      } else {\n        valuesByKey.set(keyValue, [value]);\n      }\n    }\n\n    valuesByKey.each(function (values, key) {\n      setResult(result, key, apply(values, depth, createResult, setResult));\n    });\n    return result;\n  }\n\n  function entries(map, depth) {\n    if (++depth > keys.length) return map;\n    var array,\n        sortKey = sortKeys[depth - 1];\n    if (rollup != null && depth >= keys.length) array = map.entries();else array = [], map.each(function (v, k) {\n      array.push({\n        key: k,\n        values: entries(v, depth)\n      });\n    });\n    return sortKey != null ? array.sort(function (a, b) {\n      return sortKey(a.key, b.key);\n    }) : array;\n  }\n\n  return nest = {\n    object: function (array) {\n      return apply(array, 0, createObject, setObject);\n    },\n    map: function (array) {\n      return apply(array, 0, createMap, setMap);\n    },\n    entries: function (array) {\n      return entries(apply(array, 0, createMap, setMap), 0);\n    },\n    key: function (d) {\n      keys.push(d);\n      return nest;\n    },\n    sortKeys: function (order) {\n      sortKeys[keys.length - 1] = order;\n      return nest;\n    },\n    sortValues: function (order) {\n      sortValues = order;\n      return nest;\n    },\n    rollup: function (f) {\n      rollup = f;\n      return nest;\n    }\n  };\n}\n\nfunction createObject() {\n  return {};\n}\n\nfunction setObject(object, key, value) {\n  object[key] = value;\n}\n\nfunction createMap() {\n  return map();\n}\n\nfunction setMap(map, key, value) {\n  map.set(key, value);\n}","map":{"version":3,"names":["map","keys","sortKeys","sortValues","rollup","nest","apply","array","depth","createResult","setResult","length","sort","i","n","key","keyValue","value","valuesByKey","values","result","get","push","set","each","entries","sortKey","v","k","a","b","object","createObject","setObject","createMap","setMap","d","order","f"],"sources":["/home/chenak/QbitesReact/my-app/node_modules/d3-collection/src/nest.js"],"sourcesContent":["import map from \"./map\";\n\nexport default function() {\n  var keys = [],\n      sortKeys = [],\n      sortValues,\n      rollup,\n      nest;\n\n  function apply(array, depth, createResult, setResult) {\n    if (depth >= keys.length) {\n      if (sortValues != null) array.sort(sortValues);\n      return rollup != null ? rollup(array) : array;\n    }\n\n    var i = -1,\n        n = array.length,\n        key = keys[depth++],\n        keyValue,\n        value,\n        valuesByKey = map(),\n        values,\n        result = createResult();\n\n    while (++i < n) {\n      if (values = valuesByKey.get(keyValue = key(value = array[i]) + \"\")) {\n        values.push(value);\n      } else {\n        valuesByKey.set(keyValue, [value]);\n      }\n    }\n\n    valuesByKey.each(function(values, key) {\n      setResult(result, key, apply(values, depth, createResult, setResult));\n    });\n\n    return result;\n  }\n\n  function entries(map, depth) {\n    if (++depth > keys.length) return map;\n    var array, sortKey = sortKeys[depth - 1];\n    if (rollup != null && depth >= keys.length) array = map.entries();\n    else array = [], map.each(function(v, k) { array.push({key: k, values: entries(v, depth)}); });\n    return sortKey != null ? array.sort(function(a, b) { return sortKey(a.key, b.key); }) : array;\n  }\n\n  return nest = {\n    object: function(array) { return apply(array, 0, createObject, setObject); },\n    map: function(array) { return apply(array, 0, createMap, setMap); },\n    entries: function(array) { return entries(apply(array, 0, createMap, setMap), 0); },\n    key: function(d) { keys.push(d); return nest; },\n    sortKeys: function(order) { sortKeys[keys.length - 1] = order; return nest; },\n    sortValues: function(order) { sortValues = order; return nest; },\n    rollup: function(f) { rollup = f; return nest; }\n  };\n}\n\nfunction createObject() {\n  return {};\n}\n\nfunction setObject(object, key, value) {\n  object[key] = value;\n}\n\nfunction createMap() {\n  return map();\n}\n\nfunction setMap(map, key, value) {\n  map.set(key, value);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
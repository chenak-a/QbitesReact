{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _saveSvgAsPng = require(\"save-svg-as-png\");\n\nvar _saveSvgAsPng2 = _interopRequireDefault(_saveSvgAsPng);\n\nvar _utils = require(\"../utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar dx = 0;\nvar dy = 0;\nvar SaveChartAsImage = {\n  save: function save(doc, container, background, cb) {\n    _saveSvgAsPng2.default.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function (uri) {\n      // eslint-disable-next-line prefer-const\n      var image = new Image();\n\n      image.onload = function () {\n        // eslint-disable-next-line prefer-const\n        var canvas = doc.createElement(\"canvas\");\n        canvas.width = image.width;\n        canvas.height = image.height; // eslint-disable-next-line prefer-const\n\n        var context = canvas.getContext(\"2d\");\n\n        if ((0, _utils.isDefined)(background)) {\n          context.fillStyle = background;\n          context.fillRect(0, 0, canvas.width, canvas.height);\n        }\n\n        var canvasList = container.getElementsByTagName(\"canvas\");\n\n        for (var i = 0; i < canvasList.length; i++) {\n          var each = canvasList[i];\n\n          if ((0, _utils.isDefined)(each)) {\n            var parent = each.parentNode.parentNode.getBoundingClientRect();\n            var rect = each.getBoundingClientRect();\n            context.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\n          }\n        }\n\n        context.drawImage(image, dx, dy);\n        cb(canvas.toDataURL(\"image/png\"));\n      };\n\n      image.src = uri;\n    });\n  },\n  saveWithWhiteBG: function saveWithWhiteBG(doc, container, cb) {\n    return this.saveWithBG(doc, container, \"white\", cb);\n  },\n  saveWithDarkBG: function saveWithDarkBG(doc, container, cb) {\n    return this.saveWithBG(doc, container, \"#303030\", cb);\n  },\n  saveWithBG: function saveWithBG(doc, container, background, cb) {\n    return this.save(doc, container, background, cb);\n  },\n  saveChartAsImage: function saveChartAsImage(container) {\n    this.saveWithWhiteBG(document, container, function (src) {\n      var a = document.createElement(\"a\");\n      a.setAttribute(\"href\", src);\n      a.setAttribute(\"download\", \"Chart.png\");\n      document.body.appendChild(a);\n      a.addEventListener(\"click\", function ()\n      /* e */\n      {\n        a.parentNode.removeChild(a);\n      });\n      a.click();\n    });\n  }\n};\nexports.default = SaveChartAsImage;","map":{"version":3,"sources":["../../../src/lib/helper/SaveChartAsImage.js"],"names":["dx","dy","SaveChartAsImage","save","container","image","canvas","doc","context","canvasList","i","each","parent","rect","cb","saveWithWhiteBG","saveWithDarkBG","saveWithBG","saveChartAsImage","a","document"],"mappings":"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","sourcesContent":["\n\nimport saveAsPng from \"save-svg-as-png\";\nimport { isDefined } from \"../utils\";\n\nconst dx = 0;\nconst dy = 0;\n\nconst SaveChartAsImage = {\n\tsave(doc, container, background, cb) {\n\t\tsaveAsPng.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function(uri) {\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tlet image = new Image();\n\t\t\timage.onload = function() {\n\n\t\t\t\t// eslint-disable-next-line prefer-const\n\t\t\t\tlet canvas = doc.createElement(\"canvas\");\n\t\t\t\tcanvas.width = image.width;\n\t\t\t\tcanvas.height = image.height;\n\n\t\t\t\t// eslint-disable-next-line prefer-const\n\t\t\t\tlet context = canvas.getContext(\"2d\");\n\n\t\t\t\tif (isDefined(background)) {\n\t\t\t\t\tcontext.fillStyle = background;\n\t\t\t\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t}\n\t\t\t\tconst canvasList = container.getElementsByTagName(\"canvas\");\n\t\t\t\tfor (let i = 0; i < canvasList.length; i++) {\n\t\t\t\t\tconst each = canvasList[i];\n\t\t\t\t\tif (isDefined(each)) {\n\t\t\t\t\t\tconst parent = each.parentNode.parentNode.getBoundingClientRect();\n\t\t\t\t\t\tconst rect = each.getBoundingClientRect();\n\t\t\t\t\t\tcontext.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcontext.drawImage(image, dx, dy);\n\t\t\t\tcb(canvas.toDataURL(\"image/png\"));\n\t\t\t};\n\t\t\timage.src = uri;\n\t\t});\n\t},\n\tsaveWithWhiteBG(doc, container, cb) {\n\t\treturn this.saveWithBG(doc, container, \"white\", cb);\n\t},\n\tsaveWithDarkBG(doc, container, cb) {\n\t\treturn this.saveWithBG(doc, container, \"#303030\", cb);\n\t},\n\tsaveWithBG(doc, container, background, cb) {\n\t\treturn this.save(doc, container, background, cb);\n\t},\n\tsaveChartAsImage(container) {\n\t\tthis.saveWithWhiteBG(document, container, function(src) {\n\t\t\tconst a = document.createElement(\"a\");\n\t\t\ta.setAttribute(\"href\", src);\n\t\t\ta.setAttribute(\"download\", \"Chart.png\");\n\n\t\t\tdocument.body.appendChild(a);\n\t\t\ta.addEventListener(\"click\", function(/* e */) {\n\t\t\t\ta.parentNode.removeChild(a);\n\t\t\t});\n\n\t\t\ta.click();\n\t\t});\n\t}\n};\n\nexport default SaveChartAsImage;"]},"metadata":{},"sourceType":"script"}